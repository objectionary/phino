<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-name-shadowing #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">-- SPDX-FileCopyrightText: Copyright (c) 2025 Objectionary.com</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- SPDX-License-Identifier: MIT</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">LaTeX</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="LaTeX.html#explainRules"><span class="hs-identifier">explainRules</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier">rewrittensToLatex</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier">programToLaTeX</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier">defaultLatexContext</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier">LatexContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier">meetInPrograms</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#meetInProgram"><span class="hs-identifier">meetInProgram</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CST.html"><span class="hs-identifier">CST</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Encoding.html"><span class="hs-identifier">Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Encoding.html#Encoding"><span class="hs-identifier">Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Encoding.html#ASCII"><span class="hs-identifier">ASCII</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Encoding.html#withEncoding"><span class="hs-identifier">withEncoding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lining.html"><span class="hs-identifier">Lining</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lining.html#LineFormat"><span class="hs-identifier">LineFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lining.html#MULTILINE"><span class="hs-identifier">MULTILINE</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lining.html#withLineFormat"><span class="hs-identifier">withLineFormat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Matcher.html"><span class="hs-identifier">Matcher</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Misc.html"><span class="hs-identifier">Misc</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Render.html"><span class="hs-identifier">Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Render.html#Render"><span class="hs-identifier">Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Render.html#render"><span class="hs-identifier">render</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Replacer.html"><span class="hs-identifier">Replacer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Replacer.html#replaceProgram"><span class="hs-identifier">replaceProgram</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rewriter.html"><span class="hs-identifier">Rewriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Rewriter.html#Rewritten"><span class="hs-identifier">Rewritten</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Sugar.html"><span class="hs-identifier">Sugar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sugar.html#SugarType"><span class="hs-identifier">SugarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sugar.html#SWEET"><span class="hs-identifier">SWEET</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sugar.html#withSugarType"><span class="hs-identifier">withSugarType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Yaml.html"><span class="hs-identifier">Yaml</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Y</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">data</span><span> </span><span id="LatexContext"><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LatexContext"><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sugar"><span class="annot"><span class="annottext">LatexContext -&gt; SugarType
</span><a href="LaTeX.html#sugar"><span class="hs-identifier hs-var hs-var">sugar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sugar.html#SugarType"><span class="hs-identifier hs-type">SugarType</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="line"><span class="annot"><span class="annottext">LatexContext -&gt; LineFormat
</span><a href="LaTeX.html#line"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lining.html#LineFormat"><span class="hs-identifier hs-type">LineFormat</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nonumber"><span class="annot"><span class="annottext">LatexContext -&gt; Bool
</span><a href="LaTeX.html#nonumber"><span class="hs-identifier hs-var hs-var">nonumber</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="compress"><span class="annot"><span class="annottext">LatexContext -&gt; Bool
</span><a href="LaTeX.html#compress"><span class="hs-identifier hs-var hs-var">compress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="expression"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#expression"><span class="hs-identifier hs-var hs-var">expression</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="label"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="meetPrefix"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#meetPrefix"><span class="hs-identifier hs-var hs-var">meetPrefix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-type">defaultLatexContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span>
</span><span id="line-44"></span><span id="defaultLatexContext"><span class="annot"><span class="annottext">defaultLatexContext :: LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var hs-var">defaultLatexContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SugarType
-&gt; LineFormat
-&gt; Bool
-&gt; Bool
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; LatexContext
</span><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span><span> </span><span class="annot"><span class="annottext">SugarType
</span><a href="Sugar.html#SWEET"><span class="hs-identifier hs-var">SWEET</span></a></span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="Lining.html#MULTILINE"><span class="hs-identifier hs-var">MULTILINE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="annot"><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-type">meetInProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span id="meetInProgram"><span class="annot"><span class="annottext">meetInProgram :: Program -&gt; Program -&gt; [Expression]
</span><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-var hs-var">meetInProgram</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span id="local-6989586621679221473"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221473"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221473"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-type">meetInExpression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679221474"><span class="annot"><span class="annottext">meetInExpression :: Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var hs-var">meetInExpression</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExThis"><span class="hs-identifier hs-var">ExThis</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExTermination"><span class="hs-identifier hs-var">ExTermination</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExFormation"><span class="hs-identifier hs-type">ExFormation</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#BiVoid"><span class="hs-identifier hs-type">BiVoid</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="AST.html#AtRho"><span class="hs-identifier hs-var">AtRho</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExFormation"><span class="hs-identifier hs-type">ExFormation</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#BiDelta"><span class="hs-identifier hs-type">BiDelta</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AST.html#BiVoid"><span class="hs-identifier hs-type">BiVoid</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="AST.html#AtRho"><span class="hs-identifier hs-var">AtRho</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExFormation"><span class="hs-identifier hs-type">ExFormation</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExDispatch"><span class="hs-identifier hs-type">ExDispatch</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExDispatch"><span class="hs-identifier hs-type">ExDispatch</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExThis"><span class="hs-identifier hs-var">ExThis</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExDispatch"><span class="hs-identifier hs-type">ExDispatch</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExTermination"><span class="hs-identifier hs-var">ExTermination</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Misc.html#DataString"><span class="hs-identifier hs-type">DataString</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Misc.html#DataNumber"><span class="hs-identifier hs-type">DataNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExPhiMeet"><span class="hs-identifier hs-type">ExPhiMeet</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-type">ExPhiAgain</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span id="local-6989586621679221487"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221487"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679221488"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><span class="annottext">(Subst -&gt; Expression) -&gt; [Subst] -&gt; [Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Subst -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221487"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Subst]
</span><a href="Matcher.html#matchProgram"><span class="hs-identifier hs-var">matchProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221487"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221487"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><a href="AST.html#ExDispatch"><span class="hs-identifier hs-type">ExDispatch</span></a></span><span> </span><span id="local-6989586621679221491"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221491"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221491"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><a href="AST.html#ExApplication"><span class="hs-identifier hs-type">ExApplication</span></a></span><span> </span><span id="local-6989586621679221493"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221493"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#BiTau"><span class="hs-identifier hs-type">BiTau</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679221495"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221495"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221493"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221495"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-67"></span><span>        </span><span class="annot"><a href="AST.html#ExFormation"><span class="hs-identifier hs-type">ExFormation</span></a></span><span> </span><span id="local-6989586621679221496"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221496"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221497"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221496"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221488"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><span class="annottext">Expression
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="#local-6989586621679221497"><span class="hs-identifier hs-type">meetInBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679221497"><span class="annot"><span class="annottext">meetInBindings :: [Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221497"><span class="hs-identifier hs-var hs-var">meetInBindings</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="#local-6989586621679221497"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#BiTau"><span class="hs-identifier hs-type">BiTau</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679221498"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221498"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679221499"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221499"><span class="hs-identifier hs-var">bds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679221500"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221500"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221474"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221498"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221500"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221497"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221499"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221500"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="#local-6989586621679221497"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679221501"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221501"><span class="hs-identifier hs-var">bds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679221502"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221502"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679221497"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679221501"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221502"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><span class="hs-comment">{- | Here we're trying to compress sequence of programs with \phiMeet{} and \phiAgain LaTeX functions.
We process the sequence of programs and trying to find all expressions in first program which are present
in following programs. Then we find ONE expression which is the most frequently encountered.
If it's encountered in more than 50% of following programs - we replace it with \phiAgain{} in following
programs and with \phiMeet{} in first program.
-}</span></span><span>
</span><span id="line-80"></span><span class="annot"><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-type">meetInPrograms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span id="meetInPrograms"><span class="annot"><span class="annottext">meetInPrograms :: Maybe String -&gt; [Program] -&gt; [Program]
</span><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-var hs-var">meetInPrograms</span></a></span></span><span> </span><span id="local-6989586621679221503"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221503"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Program] -&gt; [Program]
</span><a href="#local-6989586621679221504"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="#local-6989586621679221504"><span class="hs-identifier hs-type">meetInPrograms'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679221504"><span class="annot"><span class="annottext">meetInPrograms' :: Int -&gt; [Program] -&gt; [Program]
</span><a href="#local-6989586621679221504"><span class="hs-identifier hs-var hs-var">meetInPrograms'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="#local-6989586621679221504"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679221505"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221505"><span class="hs-identifier hs-var">prog</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221505"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679221504"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span id="local-6989586621679221506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679221507"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221507"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679221508"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221508"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221509"><span class="annot"><span class="annottext">met :: [[Expression]]
</span><a href="#local-6989586621679221509"><span class="hs-identifier hs-var hs-var">met</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Program -&gt; [Expression]) -&gt; [Program] -&gt; [[Expression]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; Program -&gt; [Expression]
</span><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-var">meetInProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221507"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221508"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-88"></span><span>          </span><span id="local-6989586621679221513"><span class="annot"><span class="annottext">unique :: [Expression]
</span><a href="#local-6989586621679221513"><span class="hs-identifier hs-var hs-var">unique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; [Expression]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221509"><span class="hs-identifier hs-var">met</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679221518"><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679221518"><span class="hs-identifier hs-var">frequent</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-90"></span><span>            </span><span class="annot"><span class="annottext">((Maybe Expression, Int) -&gt; Expression -&gt; (Maybe Expression, Int))
-&gt; (Maybe Expression, Int)
-&gt; [Expression]
-&gt; (Maybe Expression, Int)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span>
</span><span id="line-91"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679221520"><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679221520"><span class="hs-identifier hs-var">best</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679221521"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221521"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679221522"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221522"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221526"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679221526"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Expression] -&gt; Bool) -&gt; [[Expression]] -&gt; [[Expression]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; [Expression] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221522"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221509"><span class="hs-identifier hs-var">met</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221526"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221521"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-94"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Maybe Expression
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221522"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221526"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679221520"><span class="hs-identifier hs-var">best</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221521"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expression
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>              </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679221513"><span class="hs-identifier hs-var">unique</span></a></span><span>
</span><span id="line-99"></span><span>          </span><span id="local-6989586621679221530"><span class="annot"><span class="annottext">next :: [Program]
</span><a href="#local-6989586621679221530"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221507"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; [Program] -&gt; [Program]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Program] -&gt; [Program]
</span><a href="#local-6989586621679221504"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221508"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-100"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679221518"><span class="hs-identifier hs-var">frequent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679221531"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221531"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Subst]
</span><a href="Matcher.html#matchProgram"><span class="hs-identifier hs-var">matchProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221531"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221507"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679221532"><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679221532"><span class="hs-identifier hs-var">substs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221534"><span class="annot"><span class="annottext">met' :: [[Expression]]
</span><a href="#local-6989586621679221534"><span class="hs-identifier hs-var hs-var">met'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Expression] -&gt; [Expression]) -&gt; [[Expression]] -&gt; [[Expression]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Bool) -&gt; [Expression] -&gt; [Expression]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Expression -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221531"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221509"><span class="hs-identifier hs-var">met</span></a></span><span>
</span><span id="line-105"></span><span>                      </span><span id="local-6989586621679221535"><span class="annot"><span class="annottext">prog :: Program
</span><a href="#local-6989586621679221535"><span class="hs-identifier hs-var hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221507"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221531"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiMeet"><span class="hs-identifier hs-var">ExPhiMeet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221503"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>                      </span><span id="local-6989586621679221536"><span class="annot"><span class="annottext">prog' :: Program
</span><a href="#local-6989586621679221536"><span class="hs-identifier hs-var hs-var">prog'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221535"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Expression) -&gt; [Subst] -&gt; [Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Subst -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679221531"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679221532"><span class="hs-identifier hs-var">substs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Expression -&gt; Expression)
-&gt; [Subst] -&gt; [Expression -&gt; Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Expression) -&gt; Subst -&gt; Expression -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-var">ExPhiAgain</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221503"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679221532"><span class="hs-identifier hs-var">substs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                      </span><span id="local-6989586621679221537"><span class="annot"><span class="annottext">rest' :: [Program]
</span><a href="#local-6989586621679221537"><span class="hs-identifier hs-var hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Program -&gt; [Expression] -&gt; Program)
-&gt; [Program] -&gt; [[Expression]] -&gt; [Program]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679221539"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221539"><span class="hs-identifier hs-var">prgm</span></a></span></span><span> </span><span id="local-6989586621679221540"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679221540"><span class="hs-identifier hs-var">exprs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221539"><span class="hs-identifier hs-var">prgm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679221540"><span class="hs-identifier hs-var">exprs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Expression -&gt; Expression -&gt; Expression)
-&gt; [Expression] -&gt; [Expression -&gt; Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Expression)
-&gt; Expression -&gt; Expression -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-var">ExPhiAgain</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221503"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679221540"><span class="hs-identifier hs-var">exprs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221508"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221534"><span class="hs-identifier hs-var">met'</span></a></span><span>
</span><span id="line-108"></span><span>                      </span><span id="local-6989586621679221542"><span class="annot"><span class="annottext">found :: [[Expression]]
</span><a href="#local-6989586621679221542"><span class="hs-identifier hs-var hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Expression] -&gt; Bool) -&gt; [[Expression]] -&gt; [[Expression]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([Expression] -&gt; Bool) -&gt; [Expression] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221534"><span class="hs-identifier hs-var">met'</span></a></span><span>
</span><span id="line-109"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221534"><span class="hs-identifier hs-var">met'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Misc.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221542"><span class="hs-identifier hs-var">found</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Misc.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679221534"><span class="hs-identifier hs-var">met'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-110"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221536"><span class="hs-identifier hs-var">prog'</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; [Program] -&gt; [Program]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Program] -&gt; [Program]
</span><a href="#local-6989586621679221504"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221506"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221537"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-111"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221530"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-112"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221530"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="annottext">Maybe Expression
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221530"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-type">renderToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-116"></span><span id="renderToLatex"><span class="annot"><span class="annottext">renderToLatex :: Program -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var hs-var">renderToLatex</span></a></span></span><span> </span><span id="local-6989586621679221551"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221551"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221552"><span id="local-6989586621679221553"><span id="local-6989586621679221554"><span id="local-6989586621679221555"><span id="local-6989586621679221556"><span id="local-6989586621679221557"><span id="local-6989586621679221558"><span class="annot"><span class="annottext">Bool
Maybe String
LineFormat
SugarType
sugar :: LatexContext -&gt; SugarType
line :: LatexContext -&gt; LineFormat
nonumber :: LatexContext -&gt; Bool
compress :: LatexContext -&gt; Bool
expression :: LatexContext -&gt; Maybe String
label :: LatexContext -&gt; Maybe String
meetPrefix :: LatexContext -&gt; Maybe String
sugar :: SugarType
line :: LineFormat
nonumber :: Bool
compress :: Bool
expression :: Maybe String
label :: Maybe String
meetPrefix :: Maybe String
</span><a href="LaTeX.html#sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PROGRAM -&gt; String
forall a. Render a =&gt; a -&gt; String
</span><a href="Render.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PROGRAM -&gt; PROGRAM
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">(PROGRAM -&gt; PROGRAM) -&gt; PROGRAM -&gt; PROGRAM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LineFormat -&gt; PROGRAM -&gt; PROGRAM
forall a. ToSingleLine a =&gt; LineFormat -&gt; a -&gt; a
</span><a href="Lining.html#withLineFormat"><span class="hs-identifier hs-var">withLineFormat</span></a></span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679221553"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">(PROGRAM -&gt; PROGRAM) -&gt; PROGRAM -&gt; PROGRAM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; PROGRAM -&gt; PROGRAM
forall a. ToASCII a =&gt; Encoding -&gt; a -&gt; a
</span><a href="Encoding.html#withEncoding"><span class="hs-identifier hs-var">withEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="Encoding.html#ASCII"><span class="hs-identifier hs-var">ASCII</span></a></span><span> </span><span class="annot"><span class="annottext">(PROGRAM -&gt; PROGRAM) -&gt; PROGRAM -&gt; PROGRAM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SugarType -&gt; PROGRAM -&gt; PROGRAM
forall a. ToSalty a =&gt; SugarType -&gt; a -&gt; a
</span><a href="Sugar.html#withSugarType"><span class="hs-identifier hs-var">withSugarType</span></a></span><span> </span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679221552"><span class="hs-identifier hs-var">sugar</span></a></span><span> </span><span class="annot"><span class="annottext">(PROGRAM -&gt; PROGRAM) -&gt; PROGRAM -&gt; PROGRAM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Program -&gt; PROGRAM
</span><a href="CST.html#programToCST"><span class="hs-identifier hs-var">programToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221551"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-type">phiquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-119"></span><span id="phiquation"><span class="annot"><span class="annottext">phiquation :: LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var hs-var">phiquation</span></a></span></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">nonumber :: LatexContext -&gt; Bool
</span><a href="LaTeX.html#nonumber"><span class="hs-identifier hs-var">nonumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phiquation*&quot;</span></span><span>
</span><span id="line-120"></span><span class="annot"><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">nonumber :: LatexContext -&gt; Bool
</span><a href="LaTeX.html#nonumber"><span class="hs-identifier hs-var">nonumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phiquation&quot;</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier hs-type">rewrittensToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Rewriter.html#Rewritten"><span class="hs-identifier hs-type">Rewritten</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-123"></span><span id="rewrittensToLatex"><span class="annot"><span class="annottext">rewrittensToLatex :: [Rewritten] -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier hs-var hs-var">rewrittensToLatex</span></a></span></span><span> </span><span id="local-6989586621679221562"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679221562"><span class="hs-identifier hs-var">rewrittens</span></a></span></span><span> </span><span id="local-6989586621679221563"><span class="annot"><span class="annottext">ctx :: LatexContext
</span><a href="#local-6989586621679221563"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221564"><span id="local-6989586621679221565"><span id="local-6989586621679221566"><span id="local-6989586621679221567"><span id="local-6989586621679221568"><span id="local-6989586621679221569"><span id="local-6989586621679221570"><span class="annot"><span class="annottext">Bool
Maybe String
LineFormat
SugarType
sugar :: LatexContext -&gt; SugarType
line :: LatexContext -&gt; LineFormat
nonumber :: LatexContext -&gt; Bool
compress :: LatexContext -&gt; Bool
expression :: LatexContext -&gt; Maybe String
label :: LatexContext -&gt; Maybe String
meetPrefix :: LatexContext -&gt; Maybe String
sugar :: SugarType
line :: LineFormat
nonumber :: Bool
compress :: Bool
expression :: Maybe String
label :: Maybe String
meetPrefix :: Maybe String
</span><a href="LaTeX.html#sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221571"><span class="annot"><span class="annottext">equation :: String
</span><a href="#local-6989586621679221571"><span class="hs-identifier hs-var hs-var">equation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679221563"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679221572"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221572"><span class="hs-identifier hs-var">progs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679221573"><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679221573"><span class="hs-identifier hs-var">rules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; ([Program], [Maybe String])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679221562"><span class="hs-identifier hs-var">rewrittens</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span id="local-6989586621679221575"><span class="annot"><span class="annottext">rewrittens' :: [Rewritten]
</span><a href="#local-6989586621679221575"><span class="hs-identifier hs-var hs-var">rewrittens'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679221567"><span class="hs-identifier hs-var">compress</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; [Maybe String] -&gt; [Rewritten]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; [Program] -&gt; [Program]
</span><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-var">meetInPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221570"><span class="hs-identifier hs-var">meetPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679221572"><span class="hs-identifier hs-var">progs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679221573"><span class="hs-identifier hs-var">rules</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679221562"><span class="hs-identifier hs-var">rewrittens</span></a></span><span>
</span><span id="line-127"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\begin{%s}\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221571"><span class="hs-identifier hs-var">equation</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\label{%s}\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221569"><span class="hs-keyword hs-var">label</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\phiExpression{%s} &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221568"><span class="hs-identifier hs-var">expression</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-132"></span><span>            </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  \\leadsto &quot;</span></span><span>
</span><span id="line-133"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(Rewritten -&gt; String) -&gt; [Rewritten] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-134"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679221577"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221577"><span class="hs-identifier hs-var">program</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679221578"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221578"><span class="hs-identifier hs-var">maybeName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221579"><span class="annot"><span class="annottext">prog :: String
</span><a href="#local-6989586621679221579"><span class="hs-identifier hs-var hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221577"><span class="hs-identifier hs-var">program</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679221563"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-136"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221579"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%s \\leadsto_{\\nameref{r:%s}}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221579"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221578"><span class="hs-identifier hs-var">maybeName</span></a></span><span>
</span><span id="line-137"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>                </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679221575"><span class="hs-identifier hs-var">rewrittens'</span></a></span><span>
</span><span id="line-139"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.\n\\end{%s}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221571"><span class="hs-identifier hs-var">equation</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier hs-type">programToLaTeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-144"></span><span id="programToLaTeX"><span class="annot"><span class="annottext">programToLaTeX :: Program -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier hs-var hs-var">programToLaTeX</span></a></span></span><span> </span><span id="local-6989586621679221580"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221580"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621679221581"><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679221581"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679221582"><span class="annot"><span class="annottext">equation :: String
</span><a href="#local-6989586621679221582"><span class="hs-identifier hs-var hs-var">equation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679221581"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-146"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\begin{&quot;</span></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221582"><span class="hs-identifier hs-var">equation</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}\n&quot;</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Program -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679221580"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679221581"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n\\end{&quot;</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221582"><span class="hs-identifier hs-var">equation</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="LaTeX.html#piped"><span class="hs-identifier hs-type">piped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-157"></span><span id="piped"><span class="annot"><span class="annottext">piped :: String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var hs-var">piped</span></a></span></span><span> </span><span id="local-6989586621679221584"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221584"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221584"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">class</span><span> </span><span id="ToLaTeX"><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-var">ToLaTeX</span></a></span></span><span> </span><span id="local-6989586621679221366"><span class="annot"><a href="#local-6989586621679221366"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>  </span><span id="toLaTeX"><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-type">toLaTeX</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679221366"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679221366"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PROGRAM"><span class="hs-identifier hs-type">PROGRAM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679221590"><span class="annot"><span class="annottext">toLaTeX :: PROGRAM -&gt; PROGRAM
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#PR_SWEET"><span class="hs-identifier hs-type">PR_SWEET</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221592"><span id="local-6989586621679221593"><span id="local-6989586621679221594"><span class="annot"><span class="annottext">EXPRESSION
RCB
LCB
lcb :: LCB
expr :: EXPRESSION
rcb :: RCB
$sel:lcb:PR_SWEET :: PROGRAM -&gt; LCB
$sel:expr:PR_SWEET :: PROGRAM -&gt; EXPRESSION
$sel:rcb:PR_SWEET :: PROGRAM -&gt; RCB
</span><a href="#local-6989586621679221592"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LCB -&gt; EXPRESSION -&gt; RCB -&gt; PROGRAM
</span><a href="CST.html#PR_SWEET"><span class="hs-identifier hs-var">PR_SWEET</span></a></span><span> </span><span class="annot"><span class="annottext">LCB
</span><a href="CST.html#BIG_LCB"><span class="hs-identifier hs-var">BIG_LCB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221593"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RCB
</span><a href="CST.html#BIG_RCB"><span class="hs-identifier hs-var">BIG_RCB</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PR_SALTY"><span class="hs-identifier hs-type">PR_SALTY</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221601"><span id="local-6989586621679221602"><span id="local-6989586621679221603"><span class="annot"><span class="annottext">EXPRESSION
GLOBAL
ARROW
$sel:expr:PR_SWEET :: PROGRAM -&gt; EXPRESSION
global :: GLOBAL
arrow :: ARROW
expr :: EXPRESSION
$sel:global:PR_SWEET :: PROGRAM -&gt; GLOBAL
$sel:arrow:PR_SWEET :: PROGRAM -&gt; ARROW
</span><a href="CST.html#%24sel%3Aexpr%3APR_SWEET"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GLOBAL -&gt; ARROW -&gt; EXPRESSION -&gt; PROGRAM
</span><a href="CST.html#PR_SALTY"><span class="hs-identifier hs-var">PR_SALTY</span></a></span><span> </span><span class="annot"><span class="annottext">GLOBAL
</span><a href="#local-6989586621679221601"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679221602"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221603"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EXPRESSION"><span class="hs-identifier hs-type">EXPRESSION</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679221623"><span class="annot"><span class="annottext">toLaTeX :: EXPRESSION -&gt; EXPRESSION
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#EX_ATTR"><span class="hs-identifier hs-type">EX_ATTR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221625"><span class="annot"><span class="annottext">ATTRIBUTE
attr :: ATTRIBUTE
$sel:attr:EX_GLOBAL :: EXPRESSION -&gt; ATTRIBUTE
</span><a href="#local-6989586621679221625"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; EXPRESSION
</span><a href="CST.html#EX_ATTR"><span class="hs-identifier hs-var">EX_ATTR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221625"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_FORMATION"><span class="hs-identifier hs-type">EX_FORMATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221628"><span id="local-6989586621679221629"><span id="local-6989586621679221630"><span id="local-6989586621679221631"><span id="local-6989586621679221632"><span id="local-6989586621679221633"><span id="local-6989586621679221634"><span class="annot"><span class="annottext">BINDING
TAB
EOL
RSB
LSB
lsb :: LSB
eol :: EOL
tab :: TAB
binding :: BINDING
eol' :: EOL
tab' :: TAB
rsb :: RSB
$sel:lsb:EX_GLOBAL :: EXPRESSION -&gt; LSB
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:binding:EX_GLOBAL :: EXPRESSION -&gt; BINDING
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:rsb:EX_GLOBAL :: EXPRESSION -&gt; RSB
</span><a href="#local-6989586621679221628"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSB -&gt; EOL -&gt; TAB -&gt; BINDING -&gt; EOL -&gt; TAB -&gt; RSB -&gt; EXPRESSION
</span><a href="CST.html#EX_FORMATION"><span class="hs-identifier hs-var">EX_FORMATION</span></a></span><span> </span><span class="annot"><span class="annottext">LSB
</span><a href="#local-6989586621679221628"><span class="hs-identifier hs-var">lsb</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221629"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221630"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679221631"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221632"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221633"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">RSB
</span><a href="#local-6989586621679221634"><span class="hs-identifier hs-var">rsb</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION"><span class="hs-identifier hs-type">EX_APPLICATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221643"><span id="local-6989586621679221644"><span id="local-6989586621679221645"><span id="local-6989586621679221646"><span id="local-6989586621679221647"><span id="local-6989586621679221648"><span id="local-6989586621679221649"><span class="annot"><span class="annottext">Int
EXPRESSION
APP_BINDING
TAB
EOL
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
expr :: EXPRESSION
eol :: EOL
tab :: TAB
tau :: APP_BINDING
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:tau:EX_GLOBAL :: EXPRESSION -&gt; APP_BINDING
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; EOL -&gt; TAB -&gt; APP_BINDING -&gt; EOL -&gt; TAB -&gt; Int -&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION"><span class="hs-identifier hs-var">EX_APPLICATION</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221643"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221644"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221645"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_BINDING -&gt; APP_BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_BINDING
</span><a href="#local-6989586621679221646"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221647"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221648"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221649"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION_TAUS"><span class="hs-identifier hs-type">EX_APPLICATION_TAUS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221654"><span id="local-6989586621679221655"><span id="local-6989586621679221656"><span id="local-6989586621679221657"><span id="local-6989586621679221658"><span id="local-6989586621679221659"><span id="local-6989586621679221660"><span class="annot"><span class="annottext">Int
EXPRESSION
BINDING
TAB
EOL
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
expr :: EXPRESSION
eol :: EOL
tab :: TAB
taus :: BINDING
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:taus:EX_GLOBAL :: EXPRESSION -&gt; BINDING
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; EOL -&gt; TAB -&gt; BINDING -&gt; EOL -&gt; TAB -&gt; Int -&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION_TAUS"><span class="hs-identifier hs-var">EX_APPLICATION_TAUS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221654"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221655"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221656"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679221657"><span class="hs-identifier hs-var">taus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221658"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221659"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221660"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION_EXPRS"><span class="hs-identifier hs-type">EX_APPLICATION_EXPRS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221663"><span id="local-6989586621679221664"><span id="local-6989586621679221665"><span id="local-6989586621679221666"><span id="local-6989586621679221667"><span id="local-6989586621679221668"><span id="local-6989586621679221669"><span class="annot"><span class="annottext">Int
EXPRESSION
APP_ARG
TAB
EOL
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
expr :: EXPRESSION
eol :: EOL
tab :: TAB
args :: APP_ARG
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:args:EX_GLOBAL :: EXPRESSION -&gt; APP_ARG
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; EOL -&gt; TAB -&gt; APP_ARG -&gt; EOL -&gt; TAB -&gt; Int -&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION_EXPRS"><span class="hs-identifier hs-var">EX_APPLICATION_EXPRS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221663"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221664"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221665"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARG -&gt; APP_ARG
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARG
</span><a href="#local-6989586621679221666"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221667"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221668"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221669"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_DISPATCH"><span class="hs-identifier hs-type">EX_DISPATCH</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221672"><span id="local-6989586621679221673"><span class="annot"><span class="annottext">ATTRIBUTE
EXPRESSION
$sel:attr:EX_GLOBAL :: EXPRESSION -&gt; ATTRIBUTE
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
expr :: EXPRESSION
attr :: ATTRIBUTE
</span><a href="CST.html#%24sel%3Aattr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; ATTRIBUTE -&gt; EXPRESSION
</span><a href="CST.html#EX_DISPATCH"><span class="hs-identifier hs-var">EX_DISPATCH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221672"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221673"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_PHI_MEET"><span class="hs-identifier hs-type">EX_PHI_MEET</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221675"><span id="local-6989586621679221676"><span id="local-6989586621679221677"><span class="annot"><span class="annottext">Int
Maybe String
EXPRESSION
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
prefix :: Maybe String
idx :: Int
expr :: EXPRESSION
$sel:prefix:EX_GLOBAL :: EXPRESSION -&gt; Maybe String
$sel:idx:EX_GLOBAL :: EXPRESSION -&gt; Int
</span><a href="CST.html#%24sel%3Aexpr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; EXPRESSION -&gt; EXPRESSION
</span><a href="CST.html#EX_PHI_MEET"><span class="hs-identifier hs-var">EX_PHI_MEET</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221675"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221676"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221677"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_PHI_AGAIN"><span class="hs-identifier hs-type">EX_PHI_AGAIN</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221681"><span id="local-6989586621679221682"><span id="local-6989586621679221683"><span class="annot"><span class="annottext">Int
Maybe String
EXPRESSION
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:prefix:EX_GLOBAL :: EXPRESSION -&gt; Maybe String
$sel:idx:EX_GLOBAL :: EXPRESSION -&gt; Int
prefix :: Maybe String
idx :: Int
expr :: EXPRESSION
</span><a href="CST.html#%24sel%3Aexpr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; EXPRESSION -&gt; EXPRESSION
</span><a href="CST.html#EX_PHI_AGAIN"><span class="hs-identifier hs-var">EX_PHI_AGAIN</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679221681"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679221682"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221683"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221684"><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221684"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221684"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#ATTRIBUTE"><span class="hs-identifier hs-type">ATTRIBUTE</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679221688"><span class="annot"><span class="annottext">toLaTeX :: ATTRIBUTE -&gt; ATTRIBUTE
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#AT_LABEL"><span class="hs-identifier hs-type">AT_LABEL</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221690"><span class="annot"><span class="annottext">String
label :: String
$sel:label:AT_LABEL :: ATTRIBUTE -&gt; String
</span><a href="#local-6989586621679221690"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ATTRIBUTE
</span><a href="CST.html#AT_LABEL"><span class="hs-identifier hs-var">AT_LABEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221690"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221692"><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221692"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221692"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-type">APP_BINDING</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679221696"><span class="annot"><span class="annottext">toLaTeX :: APP_BINDING -&gt; APP_BINDING
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-type">APP_BINDING</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221698"><span class="annot"><span class="annottext">PAIR
pair :: PAIR
$sel:pair:APP_BINDING :: APP_BINDING -&gt; PAIR
</span><a href="#local-6989586621679221698"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; APP_BINDING
</span><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-var">APP_BINDING</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679221698"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BINDING"><span class="hs-identifier hs-type">BINDING</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679221704"><span class="annot"><span class="annottext">toLaTeX :: BINDING -&gt; BINDING
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#BI_PAIR"><span class="hs-identifier hs-type">BI_PAIR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221706"><span id="local-6989586621679221707"><span id="local-6989586621679221708"><span class="annot"><span class="annottext">BINDINGS
PAIR
TAB
pair :: PAIR
bindings :: BINDINGS
tab :: TAB
$sel:pair:BI_PAIR :: BINDING -&gt; PAIR
$sel:bindings:BI_PAIR :: BINDING -&gt; BINDINGS
$sel:tab:BI_PAIR :: BINDING -&gt; TAB
</span><a href="#local-6989586621679221706"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; BINDINGS -&gt; TAB -&gt; BINDING
</span><a href="CST.html#BI_PAIR"><span class="hs-identifier hs-var">BI_PAIR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679221706"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679221707"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221708"><span class="hs-identifier hs-var">tab</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221712"><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679221712"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679221712"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BINDINGS"><span class="hs-identifier hs-type">BINDINGS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679221716"><span class="annot"><span class="annottext">toLaTeX :: BINDINGS -&gt; BINDINGS
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#BDS_PAIR"><span class="hs-identifier hs-type">BDS_PAIR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221718"><span id="local-6989586621679221719"><span id="local-6989586621679221720"><span id="local-6989586621679221721"><span class="annot"><span class="annottext">BINDINGS
PAIR
TAB
EOL
eol :: EOL
tab :: TAB
pair :: PAIR
bindings :: BINDINGS
$sel:eol:BDS_PAIR :: BINDINGS -&gt; EOL
$sel:tab:BDS_PAIR :: BINDINGS -&gt; TAB
$sel:pair:BDS_PAIR :: BINDINGS -&gt; PAIR
$sel:bindings:BDS_PAIR :: BINDINGS -&gt; BINDINGS
</span><a href="#local-6989586621679221718"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EOL -&gt; TAB -&gt; PAIR -&gt; BINDINGS -&gt; BINDINGS
</span><a href="CST.html#BDS_PAIR"><span class="hs-identifier hs-var">BDS_PAIR</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221718"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221719"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679221720"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679221721"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221726"><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679221726"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679221726"><span class="hs-identifier hs-var">bds</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PAIR"><span class="hs-identifier hs-type">PAIR</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679221736"><span class="annot"><span class="annottext">toLaTeX :: PAIR -&gt; PAIR
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#PA_DELTA"><span class="hs-identifier hs-type">PA_DELTA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221738"><span class="annot"><span class="annottext">BYTES
bytes :: BYTES
$sel:bytes:PA_TAU :: PAIR -&gt; BYTES
</span><a href="#local-6989586621679221738"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BYTES -&gt; PAIR
</span><a href="CST.html#PA_DELTA%27"><span class="hs-identifier hs-var">PA_DELTA'</span></a></span><span> </span><span class="annot"><span class="annottext">BYTES
</span><a href="#local-6989586621679221738"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_LAMBDA"><span class="hs-identifier hs-type">PA_LAMBDA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221742"><span class="annot"><span class="annottext">String
func :: String
$sel:func:PA_TAU :: PAIR -&gt; String
</span><a href="#local-6989586621679221742"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PAIR
</span><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-var">PA_LAMBDA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221742"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-type">PA_LAMBDA'</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221745"><span class="annot"><span class="annottext">String
$sel:func:PA_TAU :: PAIR -&gt; String
func :: String
</span><a href="CST.html#%24sel%3Afunc%3APA_TAU"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PAIR
</span><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-var">PA_LAMBDA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221745"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_VOID"><span class="hs-identifier hs-type">PA_VOID</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221747"><span id="local-6989586621679221748"><span id="local-6989586621679221749"><span class="annot"><span class="annottext">ATTRIBUTE
VOID
ARROW
attr :: ATTRIBUTE
arrow :: ARROW
void :: VOID
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
$sel:void:PA_TAU :: PAIR -&gt; VOID
</span><a href="#local-6989586621679221747"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ARROW -&gt; VOID -&gt; PAIR
</span><a href="CST.html#PA_VOID"><span class="hs-identifier hs-var">PA_VOID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221747"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679221748"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="annot"><span class="annottext">VOID
</span><a href="#local-6989586621679221749"><span class="hs-identifier hs-var">void</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_TAU"><span class="hs-identifier hs-type">PA_TAU</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221754"><span id="local-6989586621679221755"><span id="local-6989586621679221756"><span class="annot"><span class="annottext">ATTRIBUTE
EXPRESSION
ARROW
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
attr :: ATTRIBUTE
arrow :: ARROW
expr :: EXPRESSION
$sel:expr:PA_TAU :: PAIR -&gt; EXPRESSION
</span><a href="CST.html#%24sel%3Aattr%3APA_TAU"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ARROW -&gt; EXPRESSION -&gt; PAIR
</span><a href="CST.html#PA_TAU"><span class="hs-identifier hs-var">PA_TAU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221754"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679221755"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221756"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_FORMATION"><span class="hs-identifier hs-type">PA_FORMATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221759"><span id="local-6989586621679221760"><span id="local-6989586621679221761"><span id="local-6989586621679221762"><span class="annot"><span class="annottext">[ATTRIBUTE]
ATTRIBUTE
EXPRESSION
ARROW
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
$sel:expr:PA_TAU :: PAIR -&gt; EXPRESSION
attr :: ATTRIBUTE
voids :: [ATTRIBUTE]
arrow :: ARROW
expr :: EXPRESSION
$sel:voids:PA_TAU :: PAIR -&gt; [ATTRIBUTE]
</span><a href="CST.html#%24sel%3Aattr%3APA_TAU"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; [ATTRIBUTE] -&gt; ARROW -&gt; EXPRESSION -&gt; PAIR
</span><a href="CST.html#PA_FORMATION"><span class="hs-identifier hs-var">PA_FORMATION</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679221759"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ATTRIBUTE -&gt; ATTRIBUTE) -&gt; [ATTRIBUTE] -&gt; [ATTRIBUTE]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">[ATTRIBUTE]
</span><a href="#local-6989586621679221760"><span class="hs-identifier hs-var">voids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679221761"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221762"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221764"><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679221764"><span class="hs-identifier hs-var">pair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679221764"><span class="hs-identifier hs-var">pair</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_ARG"><span class="hs-identifier hs-type">APP_ARG</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679221769"><span class="annot"><span class="annottext">toLaTeX :: APP_ARG -&gt; APP_ARG
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#APP_ARG"><span class="hs-identifier hs-type">APP_ARG</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221771"><span id="local-6989586621679221772"><span class="annot"><span class="annottext">EXPRESSION
APP_ARGS
expr :: EXPRESSION
args :: APP_ARGS
$sel:expr:APP_ARG :: APP_ARG -&gt; EXPRESSION
$sel:args:APP_ARG :: APP_ARG -&gt; APP_ARGS
</span><a href="#local-6989586621679221771"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; APP_ARGS -&gt; APP_ARG
</span><a href="CST.html#APP_ARG"><span class="hs-identifier hs-var">APP_ARG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221771"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARGS -&gt; APP_ARGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679221772"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_ARGS"><span class="hs-identifier hs-type">APP_ARGS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679221778"><span class="annot"><span class="annottext">toLaTeX :: APP_ARGS -&gt; APP_ARGS
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#AAS_EXPR"><span class="hs-identifier hs-type">AAS_EXPR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679221780"><span id="local-6989586621679221781"><span id="local-6989586621679221782"><span id="local-6989586621679221783"><span class="annot"><span class="annottext">EXPRESSION
APP_ARGS
TAB
EOL
eol :: EOL
tab :: TAB
expr :: EXPRESSION
args :: APP_ARGS
$sel:eol:AAS_EXPR :: APP_ARGS -&gt; EOL
$sel:tab:AAS_EXPR :: APP_ARGS -&gt; TAB
$sel:expr:AAS_EXPR :: APP_ARGS -&gt; EXPRESSION
$sel:args:AAS_EXPR :: APP_ARGS -&gt; APP_ARGS
</span><a href="#local-6989586621679221780"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EOL -&gt; TAB -&gt; EXPRESSION -&gt; APP_ARGS -&gt; APP_ARGS
</span><a href="CST.html#AAS_EXPR"><span class="hs-identifier hs-var">AAS_EXPR</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679221780"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679221781"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679221782"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARGS -&gt; APP_ARGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679221783"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679221788"><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679221788"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679221788"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679221794"><span class="annot"><span class="annottext">toLaTeX :: String -&gt; String
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><a href="#local-6989586621679221795"><span class="hs-identifier hs-type">escapeUnprintedChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621679221795"><span class="annot"><span class="annottext">escapeUnprintedChars :: String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var hs-var">escapeUnprintedChars</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679221796"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679221796"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679221797"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679221796"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char36{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char64{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'^'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char94{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char95{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679221796"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679221795"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679221797"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- @todo #114:30min Implement LaTeX conversion for rules.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--  Convert Rule data structure to LaTeX inference rule format.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--  Each rule should be formatted as a LaTeX inference rule with</span><span>
</span><span id="line-223"></span><span class="hs-comment">--  pattern, result, and optional conditions.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--  Tests must be added for LaTeX conversion logic.</span><span>
</span><span id="line-225"></span><span class="annot"><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-type">explainRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Yaml.html#Rule"><span class="hs-identifier hs-type">Y.Rule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-226"></span><span id="explainRule"><span class="annot"><span class="annottext">explainRule :: Rule -&gt; String
</span><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-var hs-var">explainRule</span></a></span></span><span> </span><span id="local-6989586621679221799"><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679221799"><span class="hs-identifier hs-var">rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\rule{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unnamed&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Maybe String
</span><a href="Yaml.html#name"><span class="hs-identifier hs-var">Y.name</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679221799"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- @todo #114:30min Create LaTeX document wrapper.</span><span>
</span><span id="line-229"></span><span class="hs-comment">--  Generate proper LaTeX document with tabular format for rules.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--  Each rule should be   in its own tabular environment.</span><span>
</span><span id="line-231"></span><span class="hs-comment">--  Include tests for document structure generation.</span><span>
</span><span id="line-232"></span><span class="annot"><a href="LaTeX.html#explainRules"><span class="hs-identifier hs-type">explainRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Yaml.html#Rule"><span class="hs-identifier hs-type">Y.Rule</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-233"></span><span id="explainRules"><span class="annot"><span class="annottext">explainRules :: [Rule] -&gt; String
</span><a href="LaTeX.html#explainRules"><span class="hs-identifier hs-var hs-var">explainRules</span></a></span></span><span> </span><span id="local-6989586621679221801"><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679221801"><span class="hs-identifier hs-var">rules'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\documentclass{article}&quot;</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\usepackage{amsmath}&quot;</span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\begin{document}&quot;</span></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rule -&gt; String) -&gt; [Rule] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rule -&gt; String
</span><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-var">explainRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679221801"><span class="hs-identifier hs-var">rules'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\end{document}&quot;</span></span><span>
</span><span id="line-241"></span></pre></body></html>