<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- SPDX-FileCopyrightText: Copyright (c) 2025 Objectionary.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- SPDX-License-Identifier: MIT</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">LaTeX</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="LaTeX.html#explainRules"><span class="hs-identifier">explainRules</span></a></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier">rewrittensToLatex</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier">programToLaTeX</span></a></span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#expressionToLaTeX"><span class="hs-identifier">expressionToLaTeX</span></a></span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier">defaultLatexContext</span></a></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#defaultMeetLength"><span class="hs-identifier">defaultMeetLength</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#defaultMeetPopularity"><span class="hs-identifier">defaultMeetPopularity</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier">LatexContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier">meetInPrograms</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#meetInProgram"><span class="hs-identifier">meetInProgram</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CST.html"><span class="hs-identifier">CST</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Encoding.html"><span class="hs-identifier">Encoding</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lining.html"><span class="hs-identifier">Lining</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Locator.html"><span class="hs-identifier">Locator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Locator.html#locatedExpression"><span class="hs-identifier">locatedExpression</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Margin.html"><span class="hs-identifier">Margin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Margin.html#WithMargin"><span class="hs-identifier">WithMargin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Margin.html#defaultMargin"><span class="hs-identifier">defaultMargin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Margin.html#withMargin"><span class="hs-identifier">withMargin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Matcher.html"><span class="hs-identifier">Matcher</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Misc.html"><span class="hs-identifier">Misc</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Render.html"><span class="hs-identifier">Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Render.html#Render"><span class="hs-identifier">Render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Render.html#render"><span class="hs-identifier">render</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Replacer.html"><span class="hs-identifier">Replacer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Replacer.html#replaceProgram"><span class="hs-identifier">replaceProgram</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rewriter.html"><span class="hs-identifier">Rewriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Rewriter.html#Rewritten"><span class="hs-identifier">Rewritten</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rewriter.html#Rewrittens"><span class="hs-identifier">Rewrittens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Sugar.html"><span class="hs-identifier">Sugar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sugar.html#SugarType"><span class="hs-identifier">SugarType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sugar.html#SWEET"><span class="hs-identifier">SWEET</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sugar.html#ToSalty"><span class="hs-identifier">ToSalty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Sugar.html#withSugarType"><span class="hs-identifier">withSugarType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Yaml.html"><span class="hs-identifier">Yaml</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Y</span></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">data</span><span> </span><span id="LatexContext"><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LatexContext"><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_sugar"><span class="annot"><span class="annottext">LatexContext -&gt; SugarType
</span><a href="LaTeX.html#_sugar"><span class="hs-identifier hs-var hs-var">_sugar</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Sugar.html#SugarType"><span class="hs-identifier hs-type">SugarType</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_line"><span class="annot"><span class="annottext">LatexContext -&gt; LineFormat
</span><a href="LaTeX.html#_line"><span class="hs-identifier hs-var hs-var">_line</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lining.html#LineFormat"><span class="hs-identifier hs-type">LineFormat</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_margin"><span class="annot"><span class="annottext">LatexContext -&gt; Int
</span><a href="LaTeX.html#_margin"><span class="hs-identifier hs-var hs-var">_margin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_nonumber"><span class="annot"><span class="annottext">LatexContext -&gt; Bool
</span><a href="LaTeX.html#_nonumber"><span class="hs-identifier hs-var hs-var">_nonumber</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_compress"><span class="annot"><span class="annottext">LatexContext -&gt; Bool
</span><a href="LaTeX.html#_compress"><span class="hs-identifier hs-var hs-var">_compress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_meetPopularity"><span class="annot"><span class="annottext">LatexContext -&gt; Int
</span><a href="LaTeX.html#_meetPopularity"><span class="hs-identifier hs-var hs-var">_meetPopularity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_meetLength"><span class="annot"><span class="annottext">LatexContext -&gt; Int
</span><a href="LaTeX.html#_meetLength"><span class="hs-identifier hs-var hs-var">_meetLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_focus"><span class="annot"><span class="annottext">LatexContext -&gt; Expression
</span><a href="LaTeX.html#_focus"><span class="hs-identifier hs-var hs-var">_focus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_expression"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#_expression"><span class="hs-identifier hs-var hs-var">_expression</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_label"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#_label"><span class="hs-identifier hs-var hs-var">_label</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_meetPrefix"><span class="annot"><span class="annottext">LatexContext -&gt; Maybe String
</span><a href="LaTeX.html#_meetPrefix"><span class="hs-identifier hs-var hs-var">_meetPrefix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="annot"><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-type">defaultLatexContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span>
</span><span id="line-55"></span><span id="defaultLatexContext"><span class="annot"><span class="annottext">defaultLatexContext :: LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var hs-var">defaultLatexContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SugarType
-&gt; LineFormat
-&gt; Int
-&gt; Bool
-&gt; Bool
-&gt; Int
-&gt; Int
-&gt; Expression
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; LatexContext
</span><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-var">LatexContext</span></a></span><span> </span><span class="annot"><span class="annottext">SugarType
</span><a href="Sugar.html#SWEET"><span class="hs-identifier hs-var">SWEET</span></a></span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="Lining.html#SINGLELINE"><span class="hs-identifier hs-var">SINGLELINE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Margin.html#defaultMargin"><span class="hs-identifier hs-var">defaultMargin</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="LaTeX.html#defaultMeetPopularity"><span class="hs-identifier hs-var">defaultMeetPopularity</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="LaTeX.html#defaultMeetLength"><span class="hs-identifier hs-var">defaultMeetLength</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="annot"><a href="LaTeX.html#defaultMeetPopularity"><span class="hs-identifier hs-type">defaultMeetPopularity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-58"></span><span id="defaultMeetPopularity"><span class="annot"><span class="annottext">defaultMeetPopularity :: Int
</span><a href="LaTeX.html#defaultMeetPopularity"><span class="hs-identifier hs-var hs-var">defaultMeetPopularity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="LaTeX.html#defaultMeetLength"><span class="hs-identifier hs-type">defaultMeetLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-61"></span><span id="defaultMeetLength"><span class="annot"><span class="annottext">defaultMeetLength :: Int
</span><a href="LaTeX.html#defaultMeetLength"><span class="hs-identifier hs-var hs-var">defaultMeetLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-type">meetInProgram</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span id="meetInProgram"><span class="annot"><span class="annottext">meetInProgram :: Program -&gt; Int -&gt; Program -&gt; [Expression]
</span><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-var hs-var">meetInProgram</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span id="local-6989586621679233906"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233906"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679233907"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233907"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233906"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="#local-6989586621679233908"><span class="hs-identifier hs-type">meetInExpression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679233908"><span class="annot"><span class="annottext">meetInExpression :: Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var hs-var">meetInExpression</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Misc.html#DataString"><span class="hs-identifier hs-type">DataString</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Misc.html#DataNumber"><span class="hs-identifier hs-type">DataNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExPhiMeet"><span class="hs-identifier hs-type">ExPhiMeet</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-type">ExPhiAgain</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span id="local-6989586621679233913"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233913"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679233914"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233916"><span class="annot"><span class="annottext">matched :: [Expression]
</span><a href="#local-6989586621679233916"><span class="hs-identifier hs-var hs-var">matched</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Int
</span><a href="AST.html#countNodes"><span class="hs-identifier hs-var">countNodes</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233913"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233907"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Expression) -&gt; [Subst] -&gt; [Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Subst -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233913"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Subst]
</span><a href="Matcher.html#matchProgram"><span class="hs-identifier hs-var">matchProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233913"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679233916"><span class="hs-identifier hs-var">matched</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233913"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-74"></span><span>            </span><span class="annot"><a href="AST.html#ExDispatch"><span class="hs-identifier hs-type">ExDispatch</span></a></span><span> </span><span id="local-6989586621679233921"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233921"><span class="hs-identifier hs-var">ex'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233921"><span class="hs-identifier hs-var">ex'</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-75"></span><span>            </span><span class="annot"><a href="AST.html#ExApplication"><span class="hs-identifier hs-type">ExApplication</span></a></span><span> </span><span id="local-6989586621679233923"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233923"><span class="hs-identifier hs-var">ex'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#BiTau"><span class="hs-identifier hs-type">BiTau</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679233925"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233925"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233923"><span class="hs-identifier hs-var">ex'</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233925"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-76"></span><span>            </span><span class="annot"><a href="AST.html#ExFormation"><span class="hs-identifier hs-type">ExFormation</span></a></span><span> </span><span id="local-6989586621679233927"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233927"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233928"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233927"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233914"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-77"></span><span>            </span><span class="annot"><span class="annottext">Expression
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="#local-6989586621679233928"><span class="hs-identifier hs-type">meetInBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679233928"><span class="annot"><span class="annottext">meetInBindings :: [Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233928"><span class="hs-identifier hs-var hs-var">meetInBindings</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Program
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="#local-6989586621679233928"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#BiTau"><span class="hs-identifier hs-type">BiTau</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679233929"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233929"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679233930"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233930"><span class="hs-identifier hs-var">bds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679233931"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233931"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233908"><span class="hs-identifier hs-var">meetInExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233929"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233931"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression] -&gt; [Expression]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233928"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233930"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233931"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="#local-6989586621679233928"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679233932"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233932"><span class="hs-identifier hs-var">bds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679233933"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233933"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Program -&gt; [Expression]
</span><a href="#local-6989586621679233928"><span class="hs-identifier hs-var">meetInBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679233932"><span class="hs-identifier hs-var">bds</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233933"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="annot"><span class="hs-comment">{- | Here we're trying to compress sequence of programs with \phiMeet{} and \phiAgain LaTeX functions.
We process the sequence of programs and trying to find all expressions in first program which are present
in following programs. Then we find ONE expression which is the most frequently encountered.
If it's encountered in more than specific percentage (_meetPopularity) of following programs - we replace
it with \phiAgain{} in following programs and with \phiMeet{} in first program.
-}</span></span><span>
</span><span id="line-89"></span><span class="annot"><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-type">meetInPrograms</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span id="meetInPrograms"><span class="annot"><span class="annottext">meetInPrograms :: [Program] -&gt; LatexContext -&gt; [Program]
</span><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-var hs-var">meetInPrograms</span></a></span></span><span> </span><span id="local-6989586621679233934"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233934"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679233935"><span id="local-6989586621679233936"><span id="local-6989586621679233937"><span id="local-6989586621679233938"><span id="local-6989586621679233939"><span id="local-6989586621679233940"><span id="local-6989586621679233941"><span id="local-6989586621679233942"><span id="local-6989586621679233943"><span id="local-6989586621679233944"><span id="local-6989586621679233945"><span class="annot"><span class="annottext">Bool
Int
Maybe String
Expression
SugarType
LineFormat
_sugar :: LatexContext -&gt; SugarType
_line :: LatexContext -&gt; LineFormat
_margin :: LatexContext -&gt; Int
_nonumber :: LatexContext -&gt; Bool
_compress :: LatexContext -&gt; Bool
_meetPopularity :: LatexContext -&gt; Int
_meetLength :: LatexContext -&gt; Int
_focus :: LatexContext -&gt; Expression
_expression :: LatexContext -&gt; Maybe String
_label :: LatexContext -&gt; Maybe String
_meetPrefix :: LatexContext -&gt; Maybe String
_sugar :: SugarType
_line :: LineFormat
_margin :: Int
_nonumber :: Bool
_compress :: Bool
_meetPopularity :: Int
_meetLength :: Int
_focus :: Expression
_expression :: Maybe String
_label :: Maybe String
_meetPrefix :: Maybe String
</span><a href="LaTeX.html#_sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Int -&gt; [Program]
</span><a href="#local-6989586621679233946"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233934"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="#local-6989586621679233946"><span class="hs-identifier hs-type">meetInPrograms'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679233946"><span class="annot"><span class="annottext">meetInPrograms' :: [Program] -&gt; Int -&gt; [Program]
</span><a href="#local-6989586621679233946"><span class="hs-identifier hs-var hs-var">meetInPrograms'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="#local-6989586621679233946"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679233947"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233947"><span class="hs-identifier hs-var">program</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233947"><span class="hs-identifier hs-var">program</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="#local-6989586621679233946"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679233948"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233948"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679233949"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233949"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679233950"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233951"><span class="annot"><span class="annottext">met :: [[Expression]]
</span><a href="#local-6989586621679233951"><span class="hs-identifier hs-var hs-var">met</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Program -&gt; [Expression]) -&gt; [Program] -&gt; [[Expression]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; Int -&gt; Program -&gt; [Expression]
</span><a href="LaTeX.html#meetInProgram"><span class="hs-identifier hs-var">meetInProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233948"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233941"><span class="hs-identifier hs-var">_meetLength</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233949"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-97"></span><span>          </span><span id="local-6989586621679233955"><span class="annot"><span class="annottext">unique :: [Expression]
</span><a href="#local-6989586621679233955"><span class="hs-identifier hs-var hs-var">unique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; [Expression]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; [Expression]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233951"><span class="hs-identifier hs-var">met</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679233960"><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679233960"><span class="hs-identifier hs-var">frequent</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>            </span><span class="annot"><span class="annottext">((Maybe Expression, Int) -&gt; Expression -&gt; (Maybe Expression, Int))
-&gt; (Maybe Expression, Int)
-&gt; [Expression]
-&gt; (Maybe Expression, Int)
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span>
</span><span id="line-100"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679233962"><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679233962"><span class="hs-identifier hs-var">best</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233963"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233963"><span class="hs-identifier hs-var">count</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679233964"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233964"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233968"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679233968"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Expression] -&gt; Bool) -&gt; [[Expression]] -&gt; [[Expression]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; [Expression] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233964"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233951"><span class="hs-identifier hs-var">met</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233968"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233963"><span class="hs-identifier hs-var">count</span></a></span><span>
</span><span id="line-103"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Maybe Expression
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233964"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233968"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679233962"><span class="hs-identifier hs-var">best</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233963"><span class="hs-identifier hs-var">count</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expression
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>              </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679233955"><span class="hs-identifier hs-var">unique</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span id="local-6989586621679233972"><span class="annot"><span class="annottext">next :: [Program]
</span><a href="#local-6989586621679233972"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233948"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; [Program] -&gt; [Program]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Int -&gt; [Program]
</span><a href="#local-6989586621679233946"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233949"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-109"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Expression
</span><a href="#local-6989586621679233960"><span class="hs-identifier hs-var">frequent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679233973"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233973"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; [Subst]
</span><a href="Matcher.html#matchProgram"><span class="hs-identifier hs-var">matchProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233973"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233948"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679233974"><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679233974"><span class="hs-identifier hs-var">substs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233976"><span class="annot"><span class="annottext">met' :: [[Expression]]
</span><a href="#local-6989586621679233976"><span class="hs-identifier hs-var hs-var">met'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Expression] -&gt; [Expression]) -&gt; [[Expression]] -&gt; [[Expression]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Bool) -&gt; [Expression] -&gt; [Expression]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Expression -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233973"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233951"><span class="hs-identifier hs-var">met</span></a></span><span>
</span><span id="line-114"></span><span>                      </span><span id="local-6989586621679233977"><span class="annot"><span class="annottext">program :: Program
</span><a href="#local-6989586621679233977"><span class="hs-identifier hs-var hs-var">program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233948"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233973"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiMeet"><span class="hs-identifier hs-var">ExPhiMeet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679233945"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>                      </span><span id="local-6989586621679233978"><span class="annot"><span class="annottext">program' :: Program
</span><a href="#local-6989586621679233978"><span class="hs-identifier hs-var hs-var">program'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233977"><span class="hs-identifier hs-var">program</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Expression) -&gt; [Subst] -&gt; [Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Subst -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679233973"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679233974"><span class="hs-identifier hs-var">substs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Subst -&gt; Expression -&gt; Expression)
-&gt; [Subst] -&gt; [Expression -&gt; Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Expression) -&gt; Subst -&gt; Expression -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-var">ExPhiAgain</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679233945"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679233974"><span class="hs-identifier hs-var">substs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                      </span><span id="local-6989586621679233979"><span class="annot"><span class="annottext">rest' :: [Program]
</span><a href="#local-6989586621679233979"><span class="hs-identifier hs-var hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Program -&gt; [Expression] -&gt; Program)
-&gt; [Program] -&gt; [[Expression]] -&gt; [Program]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679233981"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233981"><span class="hs-identifier hs-var">prgm</span></a></span></span><span> </span><span id="local-6989586621679233982"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679233982"><span class="hs-identifier hs-var">exprs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReplaceProgramFunc
</span><a href="Replacer.html#replaceProgram"><span class="hs-identifier hs-var">replaceProgram</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233981"><span class="hs-identifier hs-var">prgm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679233982"><span class="hs-identifier hs-var">exprs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Expression -&gt; Expression -&gt; Expression)
-&gt; [Expression] -&gt; [Expression -&gt; Expression]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Expression -&gt; Expression)
-&gt; Expression -&gt; Expression -&gt; Expression
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; Expression -&gt; Expression
</span><a href="AST.html#ExPhiAgain"><span class="hs-identifier hs-var">ExPhiAgain</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679233945"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679233982"><span class="hs-identifier hs-var">exprs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233949"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233976"><span class="hs-identifier hs-var">met'</span></a></span><span>
</span><span id="line-117"></span><span>                      </span><span id="local-6989586621679233984"><span class="annot"><span class="annottext">found :: [[Expression]]
</span><a href="#local-6989586621679233984"><span class="hs-identifier hs-var hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Expression] -&gt; Bool) -&gt; [[Expression]] -&gt; [[Expression]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([Expression] -&gt; Bool) -&gt; [Expression] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Expression] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233976"><span class="hs-identifier hs-var">met'</span></a></span><span>
</span><span id="line-118"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233976"><span class="hs-identifier hs-var">met'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Misc.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233984"><span class="hs-identifier hs-var">found</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Misc.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Expression]] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[[Expression]]
</span><a href="#local-6989586621679233976"><span class="hs-identifier hs-var">met'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233991"><span class="hs-identifier hs-var">popularity</span></a></span><span>
</span><span id="line-119"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679233978"><span class="hs-identifier hs-var">program'</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; [Program] -&gt; [Program]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; Int -&gt; [Program]
</span><a href="#local-6989586621679233946"><span class="hs-identifier hs-var">meetInPrograms'</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233979"><span class="hs-identifier hs-var">rest'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233950"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233972"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-121"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233972"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-122"></span><span>            </span><span class="annot"><span class="annottext">Maybe Expression
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679233972"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="#local-6989586621679233991"><span class="hs-identifier hs-type">popularity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679233991"><span class="annot"><span class="annottext">popularity :: Double
</span><a href="#local-6989586621679233991"><span class="hs-identifier hs-var hs-var">popularity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="Misc.html#toDouble"><span class="hs-identifier hs-var">toDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679233940"><span class="hs-identifier hs-var">_meetPopularity</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100.0</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679233693"><span class="annot"><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-type">renderToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Sugar.html#ToSalty"><span class="hs-identifier hs-type">ToSalty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Encoding.html#ToASCII"><span class="hs-identifier hs-type">ToASCII</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lining.html#ToSingleLine"><span class="hs-identifier hs-type">ToSingleLine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Margin.html#WithMargin"><span class="hs-identifier hs-type">WithMargin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Render.html#Render"><span class="hs-identifier hs-type">Render</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233693"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-127"></span><span id="renderToLatex"><span class="annot"><span class="annottext">renderToLatex :: forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var hs-var">renderToLatex</span></a></span></span><span> </span><span id="local-6989586621679234006"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234006"><span class="hs-identifier hs-var">renderable</span></a></span></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234007"><span id="local-6989586621679234008"><span id="local-6989586621679234009"><span id="local-6989586621679234010"><span id="local-6989586621679234011"><span id="local-6989586621679234012"><span id="local-6989586621679234013"><span id="local-6989586621679234014"><span id="local-6989586621679234015"><span id="local-6989586621679234016"><span id="local-6989586621679234017"><span class="annot"><span class="annottext">Bool
Int
Maybe String
Expression
SugarType
LineFormat
_sugar :: LatexContext -&gt; SugarType
_line :: LatexContext -&gt; LineFormat
_margin :: LatexContext -&gt; Int
_nonumber :: LatexContext -&gt; Bool
_compress :: LatexContext -&gt; Bool
_meetPopularity :: LatexContext -&gt; Int
_meetLength :: LatexContext -&gt; Int
_focus :: LatexContext -&gt; Expression
_expression :: LatexContext -&gt; Maybe String
_label :: LatexContext -&gt; Maybe String
_meetPrefix :: LatexContext -&gt; Maybe String
_sugar :: SugarType
_line :: LineFormat
_margin :: Int
_nonumber :: Bool
_compress :: Bool
_meetPopularity :: Int
_meetLength :: Int
_focus :: Expression
_expression :: Maybe String
_label :: Maybe String
_meetPrefix :: Maybe String
</span><a href="LaTeX.html#_sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Render a =&gt; a -&gt; String
</span><a href="Render.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LineFormat -&gt; a -&gt; a
forall a. ToSingleLine a =&gt; LineFormat -&gt; a -&gt; a
</span><a href="Lining.html#withLineFormat"><span class="hs-identifier hs-var">withLineFormat</span></a></span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679234008"><span class="hs-identifier hs-var">_line</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a
forall a. WithMargin a =&gt; Int -&gt; a -&gt; a
</span><a href="Margin.html#withMargin"><span class="hs-identifier hs-var">withMargin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234009"><span class="hs-identifier hs-var">_margin</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; a -&gt; a
forall a. ToASCII a =&gt; Encoding -&gt; a -&gt; a
</span><a href="Encoding.html#withEncoding"><span class="hs-identifier hs-var">withEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="Encoding.html#ASCII"><span class="hs-identifier hs-var">ASCII</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; a -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SugarType -&gt; a -&gt; a
forall a. ToSalty a =&gt; SugarType -&gt; a -&gt; a
</span><a href="Sugar.html#withSugarType"><span class="hs-identifier hs-var">withSugarType</span></a></span><span> </span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679234007"><span class="hs-identifier hs-var">_sugar</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234006"><span class="hs-identifier hs-var">renderable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="annot"><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-type">phiquation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-130"></span><span id="phiquation"><span class="annot"><span class="annottext">phiquation :: LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var hs-var">phiquation</span></a></span></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_nonumber :: LatexContext -&gt; Bool
</span><a href="LaTeX.html#_nonumber"><span class="hs-identifier hs-var">_nonumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phiquation*&quot;</span></span><span>
</span><span id="line-131"></span><span class="annot"><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_nonumber :: LatexContext -&gt; Bool
</span><a href="LaTeX.html#_nonumber"><span class="hs-identifier hs-var">_nonumber</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;phiquation&quot;</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="LaTeX.html#preamble"><span class="hs-identifier hs-type">preamble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-134"></span><span id="preamble"><span class="annot"><span class="annottext">preamble :: LatexContext -&gt; String
</span><a href="LaTeX.html#preamble"><span class="hs-identifier hs-var hs-var">preamble</span></a></span></span><span> </span><span id="local-6989586621679234024"><span class="annot"><span class="annottext">ctx :: LatexContext
</span><a href="#local-6989586621679234024"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234025"><span id="local-6989586621679234026"><span id="local-6989586621679234027"><span id="local-6989586621679234028"><span id="local-6989586621679234029"><span id="local-6989586621679234030"><span id="local-6989586621679234031"><span id="local-6989586621679234032"><span id="local-6989586621679234033"><span id="local-6989586621679234034"><span id="local-6989586621679234035"><span class="annot"><span class="annottext">Bool
Int
Maybe String
Expression
SugarType
LineFormat
_sugar :: LatexContext -&gt; SugarType
_line :: LatexContext -&gt; LineFormat
_margin :: LatexContext -&gt; Int
_nonumber :: LatexContext -&gt; Bool
_compress :: LatexContext -&gt; Bool
_meetPopularity :: LatexContext -&gt; Int
_meetLength :: LatexContext -&gt; Int
_focus :: LatexContext -&gt; Expression
_expression :: LatexContext -&gt; Maybe String
_label :: LatexContext -&gt; Maybe String
_meetPrefix :: LatexContext -&gt; Maybe String
_sugar :: SugarType
_line :: LineFormat
_margin :: Int
_nonumber :: Bool
_compress :: Bool
_meetPopularity :: Int
_meetLength :: Int
_focus :: Expression
_expression :: Maybe String
_label :: Maybe String
_meetPrefix :: Maybe String
</span><a href="LaTeX.html#_sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\begin{%s}\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234024"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\label{%s}\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234034"><span class="hs-identifier hs-var">_label</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\phiExpression{%s} &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234033"><span class="hs-identifier hs-var">_expression</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679233708"><span class="annot"><a href="LaTeX.html#body"><span class="hs-identifier hs-type">body</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679233708"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679233708"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-142"></span><span id="body"><span class="annot"><span class="annottext">body :: forall a. [(a, Maybe String)] -&gt; (a -&gt; String) -&gt; String
</span><a href="LaTeX.html#body"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span id="local-6989586621679234039"><span class="annot"><span class="annottext">[(a, Maybe String)]
</span><a href="#local-6989586621679234039"><span class="hs-identifier hs-var">printed</span></a></span></span><span> </span><span id="local-6989586621679234040"><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679234040"><span class="hs-identifier hs-var">toLatex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  \\leadsto &quot;</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">((a, Maybe String) -&gt; String) -&gt; [(a, Maybe String)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234041"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234041"><span class="hs-identifier hs-var">item</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234042"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234042"><span class="hs-identifier hs-var">maybeName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234043"><span class="annot"><span class="annottext">item' :: String
</span><a href="#local-6989586621679234043"><span class="hs-identifier hs-var hs-var">item'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
</span><a href="#local-6989586621679234040"><span class="hs-identifier hs-var">toLatex</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234041"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-148"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; String) -&gt; Maybe String -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234043"><span class="hs-identifier hs-var">item'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;%s \\leadsto_{\\nameref{r:%s}}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234043"><span class="hs-identifier hs-var">item'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234042"><span class="hs-identifier hs-var">maybeName</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">[(a, Maybe String)]
</span><a href="#local-6989586621679234039"><span class="hs-identifier hs-var">printed</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="LaTeX.html#ending"><span class="hs-identifier hs-type">ending</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-154"></span><span id="ending"><span class="annot"><span class="annottext">ending :: Bool -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#ending"><span class="hs-identifier hs-var hs-var">ending</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679234045"><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234045"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; \\leadsto\n  \\leadsto \\dots\n\\end{%s}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234045"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span class="annot"><a href="LaTeX.html#ending"><span class="hs-identifier hs-var">ending</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621679234046"><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234046"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{.}\n\\end{%s}&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#phiquation"><span class="hs-identifier hs-var">phiquation</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234046"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="LaTeX.html#compressedRewrittens"><span class="hs-identifier hs-type">compressedRewrittens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Rewriter.html#Rewritten"><span class="hs-identifier hs-type">Rewritten</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Rewriter.html#Rewritten"><span class="hs-identifier hs-type">Rewritten</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span id="compressedRewrittens"><span class="annot"><span class="annottext">compressedRewrittens :: [Rewritten] -&gt; LatexContext -&gt; [Rewritten]
</span><a href="LaTeX.html#compressedRewrittens"><span class="hs-identifier hs-var hs-var">compressedRewrittens</span></a></span></span><span> </span><span id="local-6989586621679234048"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234048"><span class="hs-identifier hs-var">rewrittens</span></a></span></span><span> </span><span id="local-6989586621679234049"><span class="annot"><span class="annottext">ctx :: LatexContext
</span><a href="#local-6989586621679234049"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234050"><span id="local-6989586621679234051"><span id="local-6989586621679234052"><span id="local-6989586621679234053"><span id="local-6989586621679234054"><span id="local-6989586621679234055"><span id="local-6989586621679234056"><span id="local-6989586621679234057"><span id="local-6989586621679234058"><span id="local-6989586621679234059"><span id="local-6989586621679234060"><span class="annot"><span class="annottext">Bool
Int
Maybe String
Expression
SugarType
LineFormat
_sugar :: LatexContext -&gt; SugarType
_line :: LatexContext -&gt; LineFormat
_margin :: LatexContext -&gt; Int
_nonumber :: LatexContext -&gt; Bool
_compress :: LatexContext -&gt; Bool
_meetPopularity :: LatexContext -&gt; Int
_meetLength :: LatexContext -&gt; Int
_focus :: LatexContext -&gt; Expression
_expression :: LatexContext -&gt; Maybe String
_label :: LatexContext -&gt; Maybe String
_meetPrefix :: LatexContext -&gt; Maybe String
_sugar :: SugarType
_line :: LineFormat
_margin :: Int
_nonumber :: Bool
_compress :: Bool
_meetPopularity :: Int
_meetLength :: Int
_focus :: Expression
_expression :: Maybe String
_label :: Maybe String
_meetPrefix :: Maybe String
</span><a href="LaTeX.html#_sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234061"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679234061"><span class="hs-identifier hs-var">progs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234062"><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679234062"><span class="hs-identifier hs-var">rules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; ([Program], [Maybe String])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234048"><span class="hs-identifier hs-var">rewrittens</span></a></span><span>
</span><span id="line-160"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234054"><span class="hs-identifier hs-var">_compress</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; [Maybe String] -&gt; [Rewritten]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Program] -&gt; LatexContext -&gt; [Program]
</span><a href="LaTeX.html#meetInPrograms"><span class="hs-identifier hs-var">meetInPrograms</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679234061"><span class="hs-identifier hs-var">progs</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234049"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679234062"><span class="hs-identifier hs-var">rules</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234048"><span class="hs-identifier hs-var">rewrittens</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier hs-type">rewrittensToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Rewriter.html#Rewrittens"><span class="hs-identifier hs-type">Rewrittens</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-163"></span><span id="rewrittensToLatex"><span class="annot"><span class="annottext">rewrittensToLatex :: Rewrittens -&gt; LatexContext -&gt; IO String
</span><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier hs-var hs-var">rewrittensToLatex</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234064"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234064"><span class="hs-identifier hs-var">rewrittens</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234065"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234065"><span class="hs-identifier hs-var">exceeded</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234066"><span class="annot"><span class="annottext">ctx :: LatexContext
</span><a href="#local-6989586621679234066"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">_focus :: LatexContext -&gt; Expression
</span><a href="LaTeX.html#_focus"><span class="hs-identifier hs-var">_focus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#preamble"><span class="hs-identifier hs-var">preamble</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234066"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; (Program -&gt; String) -&gt; String
forall a. [(a, Maybe String)] -&gt; (a -&gt; String) -&gt; String
</span><a href="LaTeX.html#body"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; LatexContext -&gt; [Rewritten]
</span><a href="LaTeX.html#compressedRewrittens"><span class="hs-identifier hs-var">compressedRewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234064"><span class="hs-identifier hs-var">rewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234066"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679234067"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679234067"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PROGRAM -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; PROGRAM
</span><a href="CST.html#programToCST"><span class="hs-identifier hs-var">programToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679234067"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234066"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#ending"><span class="hs-identifier hs-var">ending</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234065"><span class="hs-identifier hs-var">exceeded</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234066"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span class="annot"><a href="LaTeX.html#rewrittensToLatex"><span class="hs-identifier hs-var">rewrittensToLatex</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234069"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234069"><span class="hs-identifier hs-var">rewrittens</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234070"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234070"><span class="hs-identifier hs-var">exceeded</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234071"><span class="annot"><span class="annottext">ctx :: LatexContext
</span><a href="#local-6989586621679234071"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234072"><span id="local-6989586621679234073"><span id="local-6989586621679234074"><span id="local-6989586621679234075"><span id="local-6989586621679234076"><span id="local-6989586621679234077"><span id="local-6989586621679234078"><span id="local-6989586621679234079"><span id="local-6989586621679234080"><span id="local-6989586621679234081"><span id="local-6989586621679234082"><span class="annot"><span class="annottext">Bool
Int
Maybe String
Expression
SugarType
LineFormat
_sugar :: LatexContext -&gt; SugarType
_line :: LatexContext -&gt; LineFormat
_margin :: LatexContext -&gt; Int
_nonumber :: LatexContext -&gt; Bool
_compress :: LatexContext -&gt; Bool
_meetPopularity :: LatexContext -&gt; Int
_meetLength :: LatexContext -&gt; Int
_focus :: LatexContext -&gt; Expression
_expression :: LatexContext -&gt; Maybe String
_label :: LatexContext -&gt; Maybe String
_meetPrefix :: LatexContext -&gt; Maybe String
_sugar :: SugarType
_line :: LineFormat
_margin :: Int
_nonumber :: Bool
_compress :: Bool
_meetPopularity :: Int
_meetLength :: Int
_focus :: Expression
_expression :: Maybe String
_label :: Maybe String
_meetPrefix :: Maybe String
</span><a href="LaTeX.html#_sugar"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234083"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679234083"><span class="hs-identifier hs-var">progs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234084"><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679234084"><span class="hs-identifier hs-var">rules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; ([Program], [Maybe String])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; LatexContext -&gt; [Rewritten]
</span><a href="LaTeX.html#compressedRewrittens"><span class="hs-identifier hs-var">compressedRewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679234069"><span class="hs-identifier hs-var">rewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234071"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679234085"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679234085"><span class="hs-identifier hs-var">exprs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Program -&gt; IO Expression) -&gt; [Program] -&gt; IO [Expression]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; IO Expression
</span><a href="Locator.html#locatedExpression"><span class="hs-identifier hs-var">locatedExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679234079"><span class="hs-identifier hs-var">_focus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679234083"><span class="hs-identifier hs-var">progs</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#preamble"><span class="hs-identifier hs-var">preamble</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234071"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Expression, Maybe String)] -&gt; (Expression -&gt; String) -&gt; String
forall a. [(a, Maybe String)] -&gt; (a -&gt; String) -&gt; String
</span><a href="LaTeX.html#body"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expression] -&gt; [Maybe String] -&gt; [(Expression, Maybe String)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679234085"><span class="hs-identifier hs-var">exprs</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe String]
</span><a href="#local-6989586621679234084"><span class="hs-identifier hs-var">rules</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679234087"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679234087"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; EXPRESSION
</span><a href="CST.html#expressionToCST"><span class="hs-identifier hs-var">expressionToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679234087"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234071"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#ending"><span class="hs-identifier hs-var">ending</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234070"><span class="hs-identifier hs-var">exceeded</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234071"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier hs-type">programToLaTeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-183"></span><span id="programToLaTeX"><span class="annot"><span class="annottext">programToLaTeX :: Program -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#programToLaTeX"><span class="hs-identifier hs-var hs-var">programToLaTeX</span></a></span></span><span> </span><span id="local-6989586621679234089"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679234089"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621679234090"><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234090"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#preamble"><span class="hs-identifier hs-var">preamble</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234090"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PROGRAM -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; PROGRAM
</span><a href="CST.html#programToCST"><span class="hs-identifier hs-var">programToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679234089"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234090"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#ending"><span class="hs-identifier hs-var">ending</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234090"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="LaTeX.html#expressionToLaTeX"><span class="hs-identifier hs-type">expressionToLaTeX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="LaTeX.html#LatexContext"><span class="hs-identifier hs-type">LatexContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-191"></span><span id="expressionToLaTeX"><span class="annot"><span class="annottext">expressionToLaTeX :: Expression -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#expressionToLaTeX"><span class="hs-identifier hs-var hs-var">expressionToLaTeX</span></a></span></span><span> </span><span id="local-6989586621679234091"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679234091"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679234092"><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234092"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LatexContext -&gt; String
</span><a href="LaTeX.html#preamble"><span class="hs-identifier hs-var">preamble</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234092"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; EXPRESSION
</span><a href="CST.html#expressionToCST"><span class="hs-identifier hs-var">expressionToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679234091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234092"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#ending"><span class="hs-identifier hs-var">ending</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="#local-6989586621679234092"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><a href="LaTeX.html#piped"><span class="hs-identifier hs-type">piped</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-199"></span><span id="piped"><span class="annot"><span class="annottext">piped :: String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var hs-var">piped</span></a></span></span><span> </span><span id="local-6989586621679234094"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234094"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234094"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">class</span><span> </span><span id="ToLaTeX"><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-var">ToLaTeX</span></a></span></span><span> </span><span id="local-6989586621679233696"><span class="annot"><a href="#local-6989586621679233696"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="toLaTeX"><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-type">toLaTeX</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679233696"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679233696"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PROGRAM"><span class="hs-identifier hs-type">PROGRAM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679234099"><span class="annot"><span class="annottext">toLaTeX :: PROGRAM -&gt; PROGRAM
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#PR_SWEET"><span class="hs-identifier hs-type">PR_SWEET</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234101"><span id="local-6989586621679234102"><span id="local-6989586621679234103"><span id="local-6989586621679234104"><span class="annot"><span class="annottext">EXPRESSION
SPACE
RCB
LCB
lcb :: LCB
expr :: EXPRESSION
rcb :: RCB
space :: SPACE
$sel:lcb:PR_SWEET :: PROGRAM -&gt; LCB
$sel:expr:PR_SWEET :: PROGRAM -&gt; EXPRESSION
$sel:rcb:PR_SWEET :: PROGRAM -&gt; RCB
$sel:space:PR_SWEET :: PROGRAM -&gt; SPACE
</span><a href="#local-6989586621679234101"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LCB -&gt; EXPRESSION -&gt; RCB -&gt; SPACE -&gt; PROGRAM
</span><a href="CST.html#PR_SWEET"><span class="hs-identifier hs-var">PR_SWEET</span></a></span><span> </span><span class="annot"><span class="annottext">LCB
</span><a href="CST.html#BIG_LCB"><span class="hs-identifier hs-var">BIG_LCB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234102"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RCB
</span><a href="CST.html#BIG_RCB"><span class="hs-identifier hs-var">BIG_RCB</span></a></span><span> </span><span class="annot"><span class="annottext">SPACE
</span><a href="CST.html#SPACE"><span class="hs-identifier hs-var">SPACE</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PR_SALTY"><span class="hs-identifier hs-type">PR_SALTY</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234113"><span id="local-6989586621679234114"><span id="local-6989586621679234115"><span class="annot"><span class="annottext">EXPRESSION
GLOBAL
ARROW
$sel:expr:PR_SWEET :: PROGRAM -&gt; EXPRESSION
global :: GLOBAL
arrow :: ARROW
expr :: EXPRESSION
$sel:global:PR_SWEET :: PROGRAM -&gt; GLOBAL
$sel:arrow:PR_SWEET :: PROGRAM -&gt; ARROW
</span><a href="CST.html#%24sel%3Aexpr%3APR_SWEET"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GLOBAL -&gt; ARROW -&gt; EXPRESSION -&gt; PROGRAM
</span><a href="CST.html#PR_SALTY"><span class="hs-identifier hs-var">PR_SALTY</span></a></span><span> </span><span class="annot"><span class="annottext">GLOBAL
</span><a href="#local-6989586621679234113"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679234114"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234115"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EXPRESSION"><span class="hs-identifier hs-type">EXPRESSION</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621679234137"><span class="annot"><span class="annottext">toLaTeX :: EXPRESSION -&gt; EXPRESSION
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#EX_ATTR"><span class="hs-identifier hs-type">EX_ATTR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234139"><span class="annot"><span class="annottext">ATTRIBUTE
attr :: ATTRIBUTE
$sel:attr:EX_GLOBAL :: EXPRESSION -&gt; ATTRIBUTE
</span><a href="#local-6989586621679234139"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; EXPRESSION
</span><a href="CST.html#EX_ATTR"><span class="hs-identifier hs-var">EX_ATTR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234139"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_FORMATION"><span class="hs-identifier hs-type">EX_FORMATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234142"><span id="local-6989586621679234143"><span id="local-6989586621679234144"><span id="local-6989586621679234145"><span id="local-6989586621679234146"><span id="local-6989586621679234147"><span id="local-6989586621679234148"><span class="annot"><span class="annottext">BINDING
TAB
EOL
RSB
LSB
lsb :: LSB
eol :: EOL
tab :: TAB
binding :: BINDING
eol' :: EOL
tab' :: TAB
rsb :: RSB
$sel:lsb:EX_GLOBAL :: EXPRESSION -&gt; LSB
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:binding:EX_GLOBAL :: EXPRESSION -&gt; BINDING
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:rsb:EX_GLOBAL :: EXPRESSION -&gt; RSB
</span><a href="#local-6989586621679234142"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LSB -&gt; EOL -&gt; TAB -&gt; BINDING -&gt; EOL -&gt; TAB -&gt; RSB -&gt; EXPRESSION
</span><a href="CST.html#EX_FORMATION"><span class="hs-identifier hs-var">EX_FORMATION</span></a></span><span> </span><span class="annot"><span class="annottext">LSB
</span><a href="#local-6989586621679234142"><span class="hs-identifier hs-var">lsb</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234143"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234144"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234145"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234146"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234147"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">RSB
</span><a href="#local-6989586621679234148"><span class="hs-identifier hs-var">rsb</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION"><span class="hs-identifier hs-type">EX_APPLICATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234157"><span id="local-6989586621679234158"><span id="local-6989586621679234159"><span id="local-6989586621679234160"><span id="local-6989586621679234161"><span id="local-6989586621679234162"><span id="local-6989586621679234163"><span id="local-6989586621679234164"><span class="annot"><span class="annottext">Int
EXPRESSION
APP_BINDING
TAB
EOL
SPACE
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
expr :: EXPRESSION
space :: SPACE
eol :: EOL
tab :: TAB
tau :: APP_BINDING
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:space:EX_GLOBAL :: EXPRESSION -&gt; SPACE
$sel:tau:EX_GLOBAL :: EXPRESSION -&gt; APP_BINDING
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; SPACE
-&gt; EOL
-&gt; TAB
-&gt; APP_BINDING
-&gt; EOL
-&gt; TAB
-&gt; Int
-&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION"><span class="hs-identifier hs-var">EX_APPLICATION</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234157"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SPACE
</span><a href="CST.html#SPACE"><span class="hs-identifier hs-var">SPACE</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234159"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234160"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_BINDING -&gt; APP_BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_BINDING
</span><a href="#local-6989586621679234161"><span class="hs-identifier hs-var">tau</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234162"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234163"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234164"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION_TAUS"><span class="hs-identifier hs-type">EX_APPLICATION_TAUS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234170"><span id="local-6989586621679234171"><span id="local-6989586621679234172"><span id="local-6989586621679234173"><span id="local-6989586621679234174"><span id="local-6989586621679234175"><span id="local-6989586621679234176"><span id="local-6989586621679234177"><span class="annot"><span class="annottext">Int
EXPRESSION
BINDING
TAB
EOL
SPACE
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:space:EX_GLOBAL :: EXPRESSION -&gt; SPACE
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
expr :: EXPRESSION
space :: SPACE
eol :: EOL
tab :: TAB
taus :: BINDING
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:taus:EX_GLOBAL :: EXPRESSION -&gt; BINDING
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; SPACE
-&gt; EOL
-&gt; TAB
-&gt; BINDING
-&gt; EOL
-&gt; TAB
-&gt; Int
-&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION_TAUS"><span class="hs-identifier hs-var">EX_APPLICATION_TAUS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234170"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SPACE
</span><a href="CST.html#SPACE"><span class="hs-identifier hs-var">SPACE</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234172"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234173"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234174"><span class="hs-identifier hs-var">taus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234175"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234176"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234177"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_APPLICATION_EXPRS"><span class="hs-identifier hs-type">EX_APPLICATION_EXPRS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234180"><span id="local-6989586621679234181"><span id="local-6989586621679234182"><span id="local-6989586621679234183"><span id="local-6989586621679234184"><span id="local-6989586621679234185"><span id="local-6989586621679234186"><span id="local-6989586621679234187"><span class="annot"><span class="annottext">Int
EXPRESSION
APP_ARG
TAB
EOL
SPACE
$sel:eol:EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab:EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:eol':EX_GLOBAL :: EXPRESSION -&gt; EOL
$sel:tab':EX_GLOBAL :: EXPRESSION -&gt; TAB
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:space:EX_GLOBAL :: EXPRESSION -&gt; SPACE
$sel:indent:EX_GLOBAL :: EXPRESSION -&gt; Int
expr :: EXPRESSION
space :: SPACE
eol :: EOL
tab :: TAB
args :: APP_ARG
eol' :: EOL
tab' :: TAB
indent :: Int
$sel:args:EX_GLOBAL :: EXPRESSION -&gt; APP_ARG
</span><a href="CST.html#%24sel%3Aeol%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
-&gt; SPACE
-&gt; EOL
-&gt; TAB
-&gt; APP_ARG
-&gt; EOL
-&gt; TAB
-&gt; Int
-&gt; EXPRESSION
</span><a href="CST.html#EX_APPLICATION_EXPRS"><span class="hs-identifier hs-var">EX_APPLICATION_EXPRS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234180"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SPACE
</span><a href="CST.html#SPACE"><span class="hs-identifier hs-var">SPACE</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234182"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234183"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARG -&gt; APP_ARG
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARG
</span><a href="#local-6989586621679234184"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234185"><span class="hs-identifier hs-var">eol'</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234186"><span class="hs-identifier hs-var">tab'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234187"><span class="hs-identifier hs-var">indent</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_DISPATCH"><span class="hs-identifier hs-type">EX_DISPATCH</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234190"><span id="local-6989586621679234191"><span id="local-6989586621679234192"><span class="annot"><span class="annottext">ATTRIBUTE
EXPRESSION
SPACE
$sel:attr:EX_GLOBAL :: EXPRESSION -&gt; ATTRIBUTE
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:space:EX_GLOBAL :: EXPRESSION -&gt; SPACE
expr :: EXPRESSION
space :: SPACE
attr :: ATTRIBUTE
</span><a href="CST.html#%24sel%3Aattr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; SPACE -&gt; ATTRIBUTE -&gt; EXPRESSION
</span><a href="CST.html#EX_DISPATCH"><span class="hs-identifier hs-var">EX_DISPATCH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234190"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SPACE
</span><a href="CST.html#SPACE"><span class="hs-identifier hs-var">SPACE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234192"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_PHI_MEET"><span class="hs-identifier hs-type">EX_PHI_MEET</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234194"><span id="local-6989586621679234195"><span id="local-6989586621679234196"><span class="annot"><span class="annottext">Int
Maybe String
EXPRESSION
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
prefix :: Maybe String
idx :: Int
expr :: EXPRESSION
$sel:prefix:EX_GLOBAL :: EXPRESSION -&gt; Maybe String
$sel:idx:EX_GLOBAL :: EXPRESSION -&gt; Int
</span><a href="CST.html#%24sel%3Aexpr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; EXPRESSION -&gt; EXPRESSION
</span><a href="CST.html#EX_PHI_MEET"><span class="hs-identifier hs-var">EX_PHI_MEET</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234194"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234195"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234196"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_PHI_AGAIN"><span class="hs-identifier hs-type">EX_PHI_AGAIN</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234200"><span id="local-6989586621679234201"><span id="local-6989586621679234202"><span class="annot"><span class="annottext">Int
Maybe String
EXPRESSION
$sel:expr:EX_GLOBAL :: EXPRESSION -&gt; EXPRESSION
$sel:prefix:EX_GLOBAL :: EXPRESSION -&gt; Maybe String
$sel:idx:EX_GLOBAL :: EXPRESSION -&gt; Int
prefix :: Maybe String
idx :: Int
expr :: EXPRESSION
</span><a href="CST.html#%24sel%3Aexpr%3AEX_GLOBAL"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Int -&gt; EXPRESSION -&gt; EXPRESSION
</span><a href="CST.html#EX_PHI_AGAIN"><span class="hs-identifier hs-var">EX_PHI_AGAIN</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679234200"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679234201"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234202"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EX_META"><span class="hs-identifier hs-type">EX_META</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234204"><span class="annot"><span class="annottext">META
meta :: META
$sel:meta:EX_GLOBAL :: EXPRESSION -&gt; META
</span><a href="#local-6989586621679234204"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META -&gt; EXPRESSION
</span><a href="CST.html#EX_META"><span class="hs-identifier hs-var">EX_META</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234204"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234206"><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234206"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234206"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#ATTRIBUTE"><span class="hs-identifier hs-type">ATTRIBUTE</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679234211"><span class="annot"><span class="annottext">toLaTeX :: ATTRIBUTE -&gt; ATTRIBUTE
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#AT_LABEL"><span class="hs-identifier hs-type">AT_LABEL</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234213"><span class="annot"><span class="annottext">String
label :: String
$sel:label:AT_LABEL :: ATTRIBUTE -&gt; String
</span><a href="#local-6989586621679234213"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ATTRIBUTE
</span><a href="CST.html#AT_LABEL"><span class="hs-identifier hs-var">AT_LABEL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234213"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#AT_META"><span class="hs-identifier hs-type">AT_META</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234216"><span class="annot"><span class="annottext">META
meta :: META
$sel:meta:AT_LABEL :: ATTRIBUTE -&gt; META
</span><a href="#local-6989586621679234216"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META -&gt; ATTRIBUTE
</span><a href="CST.html#AT_META"><span class="hs-identifier hs-var">AT_META</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234216"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#AT_LAMBDA"><span class="hs-identifier hs-type">AT_LAMBDA</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LAMBDA -&gt; ATTRIBUTE
</span><a href="CST.html#AT_LAMBDA"><span class="hs-identifier hs-var">AT_LAMBDA</span></a></span><span> </span><span class="annot"><span class="annottext">LAMBDA
</span><a href="CST.html#LAMBDA%27"><span class="hs-identifier hs-var">LAMBDA'</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#AT_REST"><span class="hs-identifier hs-type">AT_REST</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DOTS -&gt; ATTRIBUTE
</span><a href="CST.html#AT_REST"><span class="hs-identifier hs-var">AT_REST</span></a></span><span> </span><span class="annot"><span class="annottext">DOTS
</span><a href="CST.html#DOTS%27"><span class="hs-identifier hs-var">DOTS'</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234222"><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234222"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234222"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-type">APP_BINDING</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-228"></span><span>  </span><span id="local-6989586621679234226"><span class="annot"><span class="annottext">toLaTeX :: APP_BINDING -&gt; APP_BINDING
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-type">APP_BINDING</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234228"><span class="annot"><span class="annottext">PAIR
pair :: PAIR
$sel:pair:APP_BINDING :: APP_BINDING -&gt; PAIR
</span><a href="#local-6989586621679234228"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; APP_BINDING
</span><a href="CST.html#APP_BINDING"><span class="hs-identifier hs-var">APP_BINDING</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679234228"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BINDING"><span class="hs-identifier hs-type">BINDING</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679234236"><span class="annot"><span class="annottext">toLaTeX :: BINDING -&gt; BINDING
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#BI_PAIR"><span class="hs-identifier hs-type">BI_PAIR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234238"><span id="local-6989586621679234239"><span id="local-6989586621679234240"><span class="annot"><span class="annottext">BINDINGS
PAIR
TAB
pair :: PAIR
bindings :: BINDINGS
tab :: TAB
$sel:pair:BI_PAIR :: BINDING -&gt; PAIR
$sel:bindings:BI_PAIR :: BINDING -&gt; BINDINGS
$sel:tab:BI_PAIR :: BINDING -&gt; TAB
</span><a href="#local-6989586621679234238"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; BINDINGS -&gt; TAB -&gt; BINDING
</span><a href="CST.html#BI_PAIR"><span class="hs-identifier hs-var">BI_PAIR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679234238"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234239"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234240"><span class="hs-identifier hs-var">tab</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BI_META"><span class="hs-identifier hs-type">BI_META</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234245"><span id="local-6989586621679234246"><span id="local-6989586621679234247"><span class="annot"><span class="annottext">BINDINGS
TAB
META
$sel:bindings:BI_PAIR :: BINDING -&gt; BINDINGS
$sel:tab:BI_PAIR :: BINDING -&gt; TAB
meta :: META
bindings :: BINDINGS
tab :: TAB
$sel:meta:BI_PAIR :: BINDING -&gt; META
</span><a href="CST.html#%24sel%3Abindings%3ABI_PAIR"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META -&gt; BINDINGS -&gt; TAB -&gt; BINDING
</span><a href="CST.html#BI_META"><span class="hs-identifier hs-var">BI_META</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234245"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234246"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234247"><span class="hs-identifier hs-var">tab</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234249"><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234249"><span class="hs-identifier hs-var">bd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234249"><span class="hs-identifier hs-var">bd</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BINDINGS"><span class="hs-identifier hs-type">BINDINGS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679234255"><span class="annot"><span class="annottext">toLaTeX :: BINDINGS -&gt; BINDINGS
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#BDS_PAIR"><span class="hs-identifier hs-type">BDS_PAIR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234257"><span id="local-6989586621679234258"><span id="local-6989586621679234259"><span id="local-6989586621679234260"><span class="annot"><span class="annottext">BINDINGS
PAIR
TAB
EOL
eol :: EOL
tab :: TAB
pair :: PAIR
bindings :: BINDINGS
$sel:eol:BDS_PAIR :: BINDINGS -&gt; EOL
$sel:tab:BDS_PAIR :: BINDINGS -&gt; TAB
$sel:pair:BDS_PAIR :: BINDINGS -&gt; PAIR
$sel:bindings:BDS_PAIR :: BINDINGS -&gt; BINDINGS
</span><a href="#local-6989586621679234257"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EOL -&gt; TAB -&gt; PAIR -&gt; BINDINGS -&gt; BINDINGS
</span><a href="CST.html#BDS_PAIR"><span class="hs-identifier hs-var">BDS_PAIR</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234257"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234258"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679234259"><span class="hs-identifier hs-var">pair</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234260"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#BDS_META"><span class="hs-identifier hs-type">BDS_META</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234266"><span id="local-6989586621679234267"><span id="local-6989586621679234268"><span id="local-6989586621679234269"><span class="annot"><span class="annottext">BINDINGS
TAB
META
EOL
$sel:eol:BDS_PAIR :: BINDINGS -&gt; EOL
$sel:tab:BDS_PAIR :: BINDINGS -&gt; TAB
$sel:bindings:BDS_PAIR :: BINDINGS -&gt; BINDINGS
eol :: EOL
tab :: TAB
meta :: META
bindings :: BINDINGS
$sel:meta:BDS_PAIR :: BINDINGS -&gt; META
</span><a href="CST.html#%24sel%3Aeol%3ABDS_PAIR"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EOL -&gt; TAB -&gt; META -&gt; BINDINGS -&gt; BINDINGS
</span><a href="CST.html#BDS_META"><span class="hs-identifier hs-var">BDS_META</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234266"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234267"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234268"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDINGS -&gt; BINDINGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234269"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234271"><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234271"><span class="hs-identifier hs-var">bds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDINGS
</span><a href="#local-6989586621679234271"><span class="hs-identifier hs-var">bds</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PAIR"><span class="hs-identifier hs-type">PAIR</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679234285"><span class="annot"><span class="annottext">toLaTeX :: PAIR -&gt; PAIR
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#PA_DELTA"><span class="hs-identifier hs-type">PA_DELTA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234287"><span class="annot"><span class="annottext">BYTES
bytes :: BYTES
$sel:bytes:PA_TAU :: PAIR -&gt; BYTES
</span><a href="#local-6989586621679234287"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BYTES -&gt; PAIR
</span><a href="CST.html#PA_DELTA%27"><span class="hs-identifier hs-var">PA_DELTA'</span></a></span><span> </span><span class="annot"><span class="annottext">BYTES
</span><a href="#local-6989586621679234287"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_LAMBDA"><span class="hs-identifier hs-type">PA_LAMBDA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234291"><span class="annot"><span class="annottext">String
func :: String
$sel:func:PA_TAU :: PAIR -&gt; String
</span><a href="#local-6989586621679234291"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PAIR
</span><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-var">PA_LAMBDA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234291"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-type">PA_LAMBDA'</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234294"><span class="annot"><span class="annottext">String
$sel:func:PA_TAU :: PAIR -&gt; String
func :: String
</span><a href="CST.html#%24sel%3Afunc%3APA_TAU"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; PAIR
</span><a href="CST.html#PA_LAMBDA%27"><span class="hs-identifier hs-var">PA_LAMBDA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="LaTeX.html#piped"><span class="hs-identifier hs-var">piped</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234294"><span class="hs-identifier hs-var">func</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_VOID"><span class="hs-identifier hs-type">PA_VOID</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234296"><span id="local-6989586621679234297"><span id="local-6989586621679234298"><span class="annot"><span class="annottext">ATTRIBUTE
VOID
ARROW
attr :: ATTRIBUTE
arrow :: ARROW
void :: VOID
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
$sel:void:PA_TAU :: PAIR -&gt; VOID
</span><a href="#local-6989586621679234296"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ARROW -&gt; VOID -&gt; PAIR
</span><a href="CST.html#PA_VOID"><span class="hs-identifier hs-var">PA_VOID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234296"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679234297"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="annot"><span class="annottext">VOID
</span><a href="#local-6989586621679234298"><span class="hs-identifier hs-var">void</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_TAU"><span class="hs-identifier hs-type">PA_TAU</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234303"><span id="local-6989586621679234304"><span id="local-6989586621679234305"><span class="annot"><span class="annottext">ATTRIBUTE
EXPRESSION
ARROW
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
attr :: ATTRIBUTE
arrow :: ARROW
expr :: EXPRESSION
$sel:expr:PA_TAU :: PAIR -&gt; EXPRESSION
</span><a href="CST.html#%24sel%3Aattr%3APA_TAU"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ARROW -&gt; EXPRESSION -&gt; PAIR
</span><a href="CST.html#PA_TAU"><span class="hs-identifier hs-var">PA_TAU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234303"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679234304"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_FORMATION"><span class="hs-identifier hs-type">PA_FORMATION</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234308"><span id="local-6989586621679234309"><span id="local-6989586621679234310"><span id="local-6989586621679234311"><span class="annot"><span class="annottext">[ATTRIBUTE]
ATTRIBUTE
EXPRESSION
ARROW
$sel:attr:PA_TAU :: PAIR -&gt; ATTRIBUTE
$sel:arrow:PA_TAU :: PAIR -&gt; ARROW
$sel:expr:PA_TAU :: PAIR -&gt; EXPRESSION
attr :: ATTRIBUTE
voids :: [ATTRIBUTE]
arrow :: ARROW
expr :: EXPRESSION
$sel:voids:PA_TAU :: PAIR -&gt; [ATTRIBUTE]
</span><a href="CST.html#%24sel%3Aattr%3APA_TAU"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; [ATTRIBUTE] -&gt; ARROW -&gt; EXPRESSION -&gt; PAIR
</span><a href="CST.html#PA_FORMATION"><span class="hs-identifier hs-var">PA_FORMATION</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234308"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ATTRIBUTE -&gt; ATTRIBUTE) -&gt; [ATTRIBUTE] -&gt; [ATTRIBUTE]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">[ATTRIBUTE]
</span><a href="#local-6989586621679234309"><span class="hs-identifier hs-var">voids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ARROW
</span><a href="#local-6989586621679234310"><span class="hs-identifier hs-var">arrow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234311"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_META_DELTA"><span class="hs-identifier hs-type">PA_META_DELTA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234314"><span class="annot"><span class="annottext">META
meta :: META
$sel:meta:PA_TAU :: PAIR -&gt; META
</span><a href="#local-6989586621679234314"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; PAIR
</span><a href="CST.html#PA_META_DELTA%27"><span class="hs-identifier hs-var">PA_META_DELTA'</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234314"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_META_DELTA%27"><span class="hs-identifier hs-type">PA_META_DELTA'</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234317"><span class="annot"><span class="annottext">META
$sel:meta:PA_TAU :: PAIR -&gt; META
meta :: META
</span><a href="CST.html#%24sel%3Ameta%3APA_TAU"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META -&gt; PAIR
</span><a href="CST.html#PA_META_DELTA%27"><span class="hs-identifier hs-var">PA_META_DELTA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234317"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_META_LAMBDA"><span class="hs-identifier hs-type">PA_META_LAMBDA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234319"><span class="annot"><span class="annottext">META
$sel:meta:PA_TAU :: PAIR -&gt; META
meta :: META
</span><a href="CST.html#%24sel%3Ameta%3APA_TAU"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR -&gt; PAIR
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; PAIR
</span><a href="CST.html#PA_META_LAMBDA%27"><span class="hs-identifier hs-var">PA_META_LAMBDA'</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234319"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#PA_META_LAMBDA%27"><span class="hs-identifier hs-type">PA_META_LAMBDA'</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234321"><span class="annot"><span class="annottext">META
$sel:meta:PA_TAU :: PAIR -&gt; META
meta :: META
</span><a href="CST.html#%24sel%3Ameta%3APA_TAU"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META -&gt; PAIR
</span><a href="CST.html#PA_META_LAMBDA%27"><span class="hs-identifier hs-var">PA_META_LAMBDA'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META -&gt; META
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META
</span><a href="#local-6989586621679234321"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234322"><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679234322"><span class="hs-identifier hs-var">pair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PAIR
</span><a href="#local-6989586621679234322"><span class="hs-identifier hs-var">pair</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#META"><span class="hs-identifier hs-type">META</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679234326"><span class="annot"><span class="annottext">toLaTeX :: META -&gt; META
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#META"><span class="hs-identifier hs-type">META</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234328"><span id="local-6989586621679234329"><span id="local-6989586621679234330"><span class="annot"><span class="annottext">String
EXCLAMATION
META_HEAD
excl :: EXCLAMATION
hd :: META_HEAD
rest :: String
$sel:excl:META :: META -&gt; EXCLAMATION
$sel:hd:META :: META -&gt; META_HEAD
$sel:rest:META :: META -&gt; String
</span><a href="#local-6989586621679234328"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234336"><span class="annot"><span class="annottext">idx :: Maybe Int
</span><a href="#local-6989586621679234336"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234330"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-256"></span><span>        </span><span id="local-6989586621679234341"><span class="annot"><span class="annottext">rest' :: String
</span><a href="#local-6989586621679234341"><span class="hs-identifier hs-var hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234330"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234330"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679234336"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234330"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234330"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-257"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">EXCLAMATION -&gt; META_HEAD -&gt; String -&gt; META
</span><a href="CST.html#META"><span class="hs-identifier hs-var">META</span></a></span><span> </span><span class="annot"><span class="annottext">EXCLAMATION
</span><a href="CST.html#NO_EXCL"><span class="hs-identifier hs-var">NO_EXCL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">META_HEAD -&gt; META_HEAD
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="#local-6989586621679234329"><span class="hs-identifier hs-var">hd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234341"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#META_HEAD"><span class="hs-identifier hs-type">META_HEAD</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679234345"><span class="annot"><span class="annottext">toLaTeX :: META_HEAD -&gt; META_HEAD
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#E"><span class="hs-identifier hs-var">E</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#E%27"><span class="hs-identifier hs-var">E'</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#TAU%27"><span class="hs-identifier hs-var">TAU'</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#TAU"><span class="hs-identifier hs-var">TAU</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#TAU%27"><span class="hs-identifier hs-var">TAU'</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#B%27"><span class="hs-identifier hs-var">B'</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#D"><span class="hs-identifier hs-var">D</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="CST.html#D%27"><span class="hs-identifier hs-var">D'</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234355"><span class="annot"><span class="annottext">META_HEAD
</span><a href="#local-6989586621679234355"><span class="hs-identifier hs-var">mh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">META_HEAD
</span><a href="#local-6989586621679234355"><span class="hs-identifier hs-var">mh</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_ARG"><span class="hs-identifier hs-type">APP_ARG</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679234360"><span class="annot"><span class="annottext">toLaTeX :: APP_ARG -&gt; APP_ARG
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#APP_ARG"><span class="hs-identifier hs-type">APP_ARG</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234362"><span id="local-6989586621679234363"><span class="annot"><span class="annottext">EXPRESSION
APP_ARGS
expr :: EXPRESSION
args :: APP_ARGS
$sel:expr:APP_ARG :: APP_ARG -&gt; EXPRESSION
$sel:args:APP_ARG :: APP_ARG -&gt; APP_ARGS
</span><a href="#local-6989586621679234362"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; APP_ARGS -&gt; APP_ARG
</span><a href="CST.html#APP_ARG"><span class="hs-identifier hs-var">APP_ARG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234362"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARGS -&gt; APP_ARGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679234363"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#APP_ARGS"><span class="hs-identifier hs-type">APP_ARGS</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679234369"><span class="annot"><span class="annottext">toLaTeX :: APP_ARGS -&gt; APP_ARGS
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#AAS_EXPR"><span class="hs-identifier hs-type">AAS_EXPR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234371"><span id="local-6989586621679234372"><span id="local-6989586621679234373"><span id="local-6989586621679234374"><span class="annot"><span class="annottext">EXPRESSION
APP_ARGS
TAB
EOL
eol :: EOL
tab :: TAB
expr :: EXPRESSION
args :: APP_ARGS
$sel:eol:AAS_EXPR :: APP_ARGS -&gt; EOL
$sel:tab:AAS_EXPR :: APP_ARGS -&gt; TAB
$sel:expr:AAS_EXPR :: APP_ARGS -&gt; EXPRESSION
$sel:args:AAS_EXPR :: APP_ARGS -&gt; APP_ARGS
</span><a href="#local-6989586621679234371"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EOL -&gt; TAB -&gt; EXPRESSION -&gt; APP_ARGS -&gt; APP_ARGS
</span><a href="CST.html#AAS_EXPR"><span class="hs-identifier hs-var">AAS_EXPR</span></a></span><span> </span><span class="annot"><span class="annottext">EOL
</span><a href="#local-6989586621679234371"><span class="hs-identifier hs-var">eol</span></a></span><span> </span><span class="annot"><span class="annottext">TAB
</span><a href="#local-6989586621679234372"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234373"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">APP_ARGS -&gt; APP_ARGS
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679234374"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234379"><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679234379"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">APP_ARGS
</span><a href="#local-6989586621679234379"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679234385"><span class="annot"><span class="annottext">toLaTeX :: String -&gt; String
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="#local-6989586621679234386"><span class="hs-identifier hs-type">escapeUnprintedChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-278"></span><span>      </span><span id="local-6989586621679234386"><span class="annot"><span class="annottext">escapeUnprintedChars :: String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var hs-var">escapeUnprintedChars</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234387"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679234387"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679234388"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679234387"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char36{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char64{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'^'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char94{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\char95{}&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679234387"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234386"><span class="hs-identifier hs-var">escapeUnprintedChars</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234388"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#SET"><span class="hs-identifier hs-type">SET</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679234393"><span class="annot"><span class="annottext">toLaTeX :: SET -&gt; SET
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#ST_BINDING"><span class="hs-identifier hs-type">ST_BINDING</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234395"><span class="annot"><span class="annottext">BINDING
binding :: BINDING
$sel:binding:ST_BINDING :: SET -&gt; BINDING
</span><a href="#local-6989586621679234395"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDING -&gt; SET
</span><a href="CST.html#ST_BINDING"><span class="hs-identifier hs-var">ST_BINDING</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234395"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#ST_ATTRIBUTES"><span class="hs-identifier hs-type">ST_ATTRIBUTES</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234398"><span class="annot"><span class="annottext">[ATTRIBUTE]
attrs :: [ATTRIBUTE]
$sel:attrs:ST_BINDING :: SET -&gt; [ATTRIBUTE]
</span><a href="#local-6989586621679234398"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ATTRIBUTE] -&gt; SET
</span><a href="CST.html#ST_ATTRIBUTES"><span class="hs-identifier hs-var">ST_ATTRIBUTES</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ATTRIBUTE -&gt; ATTRIBUTE) -&gt; [ATTRIBUTE] -&gt; [ATTRIBUTE]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">[ATTRIBUTE]
</span><a href="#local-6989586621679234398"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#NUMBER"><span class="hs-identifier hs-type">NUMBER</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679234404"><span class="annot"><span class="annottext">toLaTeX :: NUMBER -&gt; NUMBER
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#INDEX"><span class="hs-identifier hs-type">INDEX</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234406"><span class="annot"><span class="annottext">ATTRIBUTE
attr :: ATTRIBUTE
$sel:attr:INDEX :: NUMBER -&gt; ATTRIBUTE
</span><a href="#local-6989586621679234406"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; NUMBER
</span><a href="CST.html#INDEX"><span class="hs-identifier hs-var">INDEX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234406"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#LENGTH"><span class="hs-identifier hs-type">LENGTH</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234409"><span class="annot"><span class="annottext">BINDING
binding :: BINDING
$sel:binding:INDEX :: NUMBER -&gt; BINDING
</span><a href="#local-6989586621679234409"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDING -&gt; NUMBER
</span><a href="CST.html#LENGTH"><span class="hs-identifier hs-var">LENGTH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234409"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234411"><span class="annot"><span class="annottext">literal :: NUMBER
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">literal</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="CST.html#LITERAL"><span class="hs-identifier hs-type">LITERAL</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NUMBER
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">literal</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#COMPARABLE"><span class="hs-identifier hs-type">COMPARABLE</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679234418"><span class="annot"><span class="annottext">toLaTeX :: COMPARABLE -&gt; COMPARABLE
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#CMP_EXPR"><span class="hs-identifier hs-type">CMP_EXPR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234420"><span class="annot"><span class="annottext">EXPRESSION
expr :: EXPRESSION
$sel:expr:CMP_ATTR :: COMPARABLE -&gt; EXPRESSION
</span><a href="#local-6989586621679234420"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; COMPARABLE
</span><a href="CST.html#CMP_EXPR"><span class="hs-identifier hs-var">CMP_EXPR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234420"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CMP_ATTR"><span class="hs-identifier hs-type">CMP_ATTR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234423"><span class="annot"><span class="annottext">ATTRIBUTE
attr :: ATTRIBUTE
$sel:attr:CMP_ATTR :: COMPARABLE -&gt; ATTRIBUTE
</span><a href="#local-6989586621679234423"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; COMPARABLE
</span><a href="CST.html#CMP_ATTR"><span class="hs-identifier hs-var">CMP_ATTR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234423"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CMP_NUM"><span class="hs-identifier hs-type">CMP_NUM</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234426"><span class="annot"><span class="annottext">NUMBER
num :: NUMBER
$sel:num:CMP_ATTR :: COMPARABLE -&gt; NUMBER
</span><a href="#local-6989586621679234426"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NUMBER -&gt; COMPARABLE
</span><a href="CST.html#CMP_NUM"><span class="hs-identifier hs-var">CMP_NUM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NUMBER -&gt; NUMBER
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">NUMBER
</span><a href="#local-6989586621679234426"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CONDITION"><span class="hs-identifier hs-type">CONDITION</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679234439"><span class="annot"><span class="annottext">toLaTeX :: CONDITION -&gt; CONDITION
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#CO_BELONGS"><span class="hs-identifier hs-type">CO_BELONGS</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234441"><span id="local-6989586621679234442"><span id="local-6989586621679234443"><span class="annot"><span class="annottext">SET
BELONGING
ATTRIBUTE
attr :: ATTRIBUTE
belongs :: BELONGING
set :: SET
$sel:attr:CO_EMPTY :: CONDITION -&gt; ATTRIBUTE
$sel:belongs:CO_EMPTY :: CONDITION -&gt; BELONGING
$sel:set:CO_EMPTY :: CONDITION -&gt; SET
</span><a href="#local-6989586621679234441"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; BELONGING -&gt; SET -&gt; CONDITION
</span><a href="CST.html#CO_BELONGS"><span class="hs-identifier hs-var">CO_BELONGS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234441"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BELONGING
</span><a href="#local-6989586621679234442"><span class="hs-identifier hs-var">belongs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SET -&gt; SET
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">SET
</span><a href="#local-6989586621679234443"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_LOGIC"><span class="hs-identifier hs-type">CO_LOGIC</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234448"><span id="local-6989586621679234449"><span class="annot"><span class="annottext">[CONDITION]
LOGIC_OPERATOR
conditions :: [CONDITION]
operator :: LOGIC_OPERATOR
$sel:conditions:CO_EMPTY :: CONDITION -&gt; [CONDITION]
$sel:operator:CO_EMPTY :: CONDITION -&gt; LOGIC_OPERATOR
</span><a href="#local-6989586621679234448"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CONDITION] -&gt; LOGIC_OPERATOR -&gt; CONDITION
</span><a href="CST.html#CO_LOGIC"><span class="hs-identifier hs-var">CO_LOGIC</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(CONDITION -&gt; CONDITION) -&gt; [CONDITION] -&gt; [CONDITION]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">CONDITION -&gt; CONDITION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">[CONDITION]
</span><a href="#local-6989586621679234448"><span class="hs-identifier hs-var">conditions</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LOGIC_OPERATOR
</span><a href="#local-6989586621679234449"><span class="hs-identifier hs-var">operator</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_NF"><span class="hs-identifier hs-type">CO_NF</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234453"><span class="annot"><span class="annottext">EXPRESSION
expr :: EXPRESSION
$sel:expr:CO_EMPTY :: CONDITION -&gt; EXPRESSION
</span><a href="#local-6989586621679234453"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; CONDITION
</span><a href="CST.html#CO_NF"><span class="hs-identifier hs-var">CO_NF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234453"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_NOT"><span class="hs-identifier hs-type">CO_NOT</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234456"><span class="annot"><span class="annottext">CONDITION
condition :: CONDITION
$sel:condition:CO_EMPTY :: CONDITION -&gt; CONDITION
</span><a href="#local-6989586621679234456"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CONDITION -&gt; CONDITION
</span><a href="CST.html#CO_NOT"><span class="hs-identifier hs-var">CO_NOT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CONDITION -&gt; CONDITION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">CONDITION
</span><a href="#local-6989586621679234456"><span class="hs-identifier hs-var">condition</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_COMPARE"><span class="hs-identifier hs-type">CO_COMPARE</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234459"><span id="local-6989586621679234460"><span id="local-6989586621679234461"><span class="annot"><span class="annottext">COMPARABLE
EQUAL
left :: COMPARABLE
equal :: EQUAL
right :: COMPARABLE
$sel:left:CO_EMPTY :: CONDITION -&gt; COMPARABLE
$sel:equal:CO_EMPTY :: CONDITION -&gt; EQUAL
$sel:right:CO_EMPTY :: CONDITION -&gt; COMPARABLE
</span><a href="#local-6989586621679234459"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">COMPARABLE -&gt; EQUAL -&gt; COMPARABLE -&gt; CONDITION
</span><a href="CST.html#CO_COMPARE"><span class="hs-identifier hs-var">CO_COMPARE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">COMPARABLE -&gt; COMPARABLE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">COMPARABLE
</span><a href="#local-6989586621679234459"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EQUAL
</span><a href="#local-6989586621679234460"><span class="hs-identifier hs-var">equal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">COMPARABLE -&gt; COMPARABLE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">COMPARABLE
</span><a href="#local-6989586621679234461"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_MATCHES"><span class="hs-identifier hs-type">CO_MATCHES</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234466"><span id="local-6989586621679234467"><span class="annot"><span class="annottext">String
EXPRESSION
$sel:expr:CO_EMPTY :: CONDITION -&gt; EXPRESSION
regex :: String
expr :: EXPRESSION
$sel:regex:CO_EMPTY :: CONDITION -&gt; String
</span><a href="CST.html#%24sel%3Aexpr%3ACO_EMPTY"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; EXPRESSION -&gt; CONDITION
</span><a href="CST.html#CO_MATCHES"><span class="hs-identifier hs-var">CO_MATCHES</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234466"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234467"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#CO_PART_OF"><span class="hs-identifier hs-type">CO_PART_OF</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234470"><span id="local-6989586621679234471"><span class="annot"><span class="annottext">EXPRESSION
BINDING
$sel:expr:CO_EMPTY :: CONDITION -&gt; EXPRESSION
expr :: EXPRESSION
binding :: BINDING
$sel:binding:CO_EMPTY :: CONDITION -&gt; BINDING
</span><a href="CST.html#%24sel%3Aexpr%3ACO_EMPTY"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; BINDING -&gt; CONDITION
</span><a href="CST.html#CO_PART_OF"><span class="hs-identifier hs-var">CO_PART_OF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234470"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234471"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">CONDITION
</span><a href="CST.html#CO_EMPTY"><span class="hs-identifier hs-var">CO_EMPTY</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CONDITION
</span><a href="CST.html#CO_EMPTY"><span class="hs-identifier hs-var">CO_EMPTY</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EXTRA_ARG"><span class="hs-identifier hs-type">EXTRA_ARG</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621679234479"><span class="annot"><span class="annottext">toLaTeX :: EXTRA_ARG -&gt; EXTRA_ARG
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#ARG_ATTR"><span class="hs-identifier hs-type">ARG_ATTR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234481"><span class="annot"><span class="annottext">ATTRIBUTE
attr :: ATTRIBUTE
$sel:attr:ARG_EXPR :: EXTRA_ARG -&gt; ATTRIBUTE
</span><a href="#local-6989586621679234481"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; EXTRA_ARG
</span><a href="CST.html#ARG_ATTR"><span class="hs-identifier hs-var">ARG_ATTR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ATTRIBUTE -&gt; ATTRIBUTE
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">ATTRIBUTE
</span><a href="#local-6989586621679234481"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#ARG_EXPR"><span class="hs-identifier hs-type">ARG_EXPR</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234484"><span class="annot"><span class="annottext">EXPRESSION
expr :: EXPRESSION
$sel:expr:ARG_EXPR :: EXTRA_ARG -&gt; EXPRESSION
</span><a href="#local-6989586621679234484"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXTRA_ARG
</span><a href="CST.html#ARG_EXPR"><span class="hs-identifier hs-var">ARG_EXPR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; EXPRESSION
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXPRESSION
</span><a href="#local-6989586621679234484"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#ARG_BINDING"><span class="hs-identifier hs-type">ARG_BINDING</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234487"><span class="annot"><span class="annottext">BINDING
binding :: BINDING
$sel:binding:ARG_EXPR :: EXTRA_ARG -&gt; BINDING
</span><a href="#local-6989586621679234487"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BINDING -&gt; EXTRA_ARG
</span><a href="CST.html#ARG_BINDING"><span class="hs-identifier hs-var">ARG_BINDING</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BINDING -&gt; BINDING
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">BINDING
</span><a href="#local-6989586621679234487"><span class="hs-identifier hs-var">binding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span id="local-6989586621679234489"><span class="annot"><span class="annottext">bts :: EXTRA_ARG
</span><a href="#local-6989586621679234489"><span class="hs-identifier hs-var">bts</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="CST.html#ARG_BYTES"><span class="hs-identifier hs-type">ARG_BYTES</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXTRA_ARG
</span><a href="#local-6989586621679234489"><span class="hs-identifier hs-var">bts</span></a></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="LaTeX.html#ToLaTeX"><span class="hs-identifier hs-type">ToLaTeX</span></a></span><span> </span><span class="annot"><a href="CST.html#EXTRA"><span class="hs-identifier hs-type">EXTRA</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679234495"><span class="annot"><span class="annottext">toLaTeX :: EXTRA -&gt; EXTRA
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var hs-var hs-var hs-var">toLaTeX</span></a></span></span><span> </span><span class="annot"><a href="CST.html#EXTRA"><span class="hs-identifier hs-type">EXTRA</span></a></span><span class="hs-special">{</span><span id="local-6989586621679234497"><span id="local-6989586621679234498"><span id="local-6989586621679234499"><span class="annot"><span class="annottext">String
[EXTRA_ARG]
EXTRA_ARG
meta :: EXTRA_ARG
func :: String
args :: [EXTRA_ARG]
$sel:meta:EXTRA :: EXTRA -&gt; EXTRA_ARG
$sel:func:EXTRA :: EXTRA -&gt; String
$sel:args:EXTRA :: EXTRA -&gt; [EXTRA_ARG]
</span><a href="#local-6989586621679234497"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EXTRA_ARG -&gt; String -&gt; [EXTRA_ARG] -&gt; EXTRA
</span><a href="CST.html#EXTRA"><span class="hs-identifier hs-var">EXTRA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXTRA_ARG -&gt; EXTRA_ARG
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">EXTRA_ARG
</span><a href="#local-6989586621679234497"><span class="hs-identifier hs-var">meta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679234498"><span class="hs-identifier hs-var">func</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(EXTRA_ARG -&gt; EXTRA_ARG) -&gt; [EXTRA_ARG] -&gt; [EXTRA_ARG]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">EXTRA_ARG -&gt; EXTRA_ARG
forall a. ToLaTeX a =&gt; a -&gt; a
</span><a href="LaTeX.html#toLaTeX"><span class="hs-identifier hs-var">toLaTeX</span></a></span><span> </span><span class="annot"><span class="annottext">[EXTRA_ARG]
</span><a href="#local-6989586621679234499"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-type">explainRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Yaml.html#Rule"><span class="hs-identifier hs-type">Y.Rule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-320"></span><span id="explainRule"><span class="annot"><span class="annottext">explainRule :: Rule -&gt; String
</span><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-var hs-var">explainRule</span></a></span></span><span> </span><span id="local-6989586621679234504"><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  &quot;</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\trrule{&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Maybe String
</span><a href="Yaml.html#name"><span class="hs-identifier hs-var">Y.name</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234506"><span class="hs-identifier hs-var">braced</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; EXPRESSION
</span><a href="CST.html#expressionToCST"><span class="hs-identifier hs-var">expressionToCST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Expression
</span><a href="Yaml.html#pattern"><span class="hs-identifier hs-var">Y.pattern</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var">defaultLatexContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234506"><span class="hs-identifier hs-var">braced</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXPRESSION -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; EXPRESSION
</span><a href="CST.html#expressionToCST"><span class="hs-identifier hs-var">expressionToCST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Expression
</span><a href="Yaml.html#result"><span class="hs-identifier hs-var">Y.result</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var">defaultLatexContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Condition -&gt; String
</span><a href="#local-6989586621679234509"><span class="hs-identifier hs-var">conditionToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Condition -&gt; Maybe Condition -&gt; Maybe Condition
</span><a href="#local-6989586621679234510"><span class="hs-identifier hs-var">joinedConditions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Maybe Condition
</span><a href="Yaml.html#when"><span class="hs-identifier hs-var">Y.when</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Maybe Condition
</span><a href="Yaml.html#having"><span class="hs-identifier hs-var">Y.having</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe [Extra] -&gt; String
</span><a href="#local-6989586621679234513"><span class="hs-identifier hs-var">extraArgumentsToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule -&gt; Maybe [Extra]
</span><a href="Yaml.html#where_"><span class="hs-identifier hs-var">Y.where_</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679234504"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="#local-6989586621679234509"><span class="hs-identifier hs-type">conditionToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Yaml.html#Condition"><span class="hs-identifier hs-type">Y.Condition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679234509"><span class="annot"><span class="annottext">conditionToLatex :: Maybe Condition -&gt; String
</span><a href="#local-6989586621679234509"><span class="hs-identifier hs-var hs-var">conditionToLatex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ }&quot;</span></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621679234509"><span class="hs-identifier hs-var">conditionToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679234515"><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234515"><span class="hs-identifier hs-var">cond</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Condition -&gt; CONDITION
</span><a href="CST.html#conditionToCST"><span class="hs-identifier hs-var">conditionToCST</span></a></span><span> </span><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234515"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">CONDITION
</span><a href="CST.html#CO_EMPTY"><span class="hs-identifier hs-var">CO_EMPTY</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ }&quot;</span></span><span>
</span><span id="line-334"></span><span>      </span><span id="local-6989586621679234517"><span class="annot"><span class="annottext">CONDITION
</span><a href="#local-6989586621679234517"><span class="hs-identifier hs-var">cond'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234506"><span class="hs-identifier hs-var">braced</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;if $ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CONDITION -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-identifier hs-var">renderToLatex</span></a></span><span> </span><span class="annot"><span class="annottext">CONDITION
</span><a href="#local-6989586621679234517"><span class="hs-identifier hs-var">cond'</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var">defaultLatexContext</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; $&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="#local-6989586621679234513"><span class="hs-identifier hs-type">extraArgumentsToLatex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Yaml.html#Extra"><span class="hs-identifier hs-type">Y.Extra</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679234513"><span class="annot"><span class="annottext">extraArgumentsToLatex :: Maybe [Extra] -&gt; String
</span><a href="#local-6989586621679234513"><span class="hs-identifier hs-var hs-var">extraArgumentsToLatex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe [Extra]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ }&quot;</span></span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="#local-6989586621679234513"><span class="hs-identifier hs-var">extraArgumentsToLatex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679234518"><span class="annot"><span class="annottext">[Extra]
</span><a href="#local-6989586621679234518"><span class="hs-identifier hs-var">extras</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234530"><span class="annot"><span class="annottext">extras' :: [String]
</span><a href="#local-6989586621679234530"><span class="hs-identifier hs-var hs-var">extras'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Extra -&gt; String) -&gt; [Extra] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">EXTRA -&gt; LatexContext -&gt; String
forall a.
(ToSalty a, ToASCII a, ToSingleLine a, ToLaTeX a, WithMargin a,
 Render a) =&gt;
a -&gt; LatexContext -&gt; String
</span><a href="LaTeX.html#renderToLatex"><span class="hs-operator hs-var">`renderToLatex`</span></a></span><span> </span><span class="annot"><span class="annottext">LatexContext
</span><a href="LaTeX.html#defaultLatexContext"><span class="hs-identifier hs-var">defaultLatexContext</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(EXTRA -&gt; String) -&gt; (Extra -&gt; EXTRA) -&gt; Extra -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Extra -&gt; EXTRA
</span><a href="CST.html#extraToCST"><span class="hs-identifier hs-var">extraToCST</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Extra]
</span><a href="#local-6989586621679234518"><span class="hs-identifier hs-var">extras</span></a></span><span>
</span><span id="line-339"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679234506"><span class="hs-identifier hs-var">braced</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;where &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679234530"><span class="hs-identifier hs-var">extras'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621679234506"><span class="hs-identifier hs-type">braced</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679234506"><span class="annot"><span class="annottext">braced :: String -&gt; String
</span><a href="#local-6989586621679234506"><span class="hs-identifier hs-var hs-var">braced</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall r. PrintfType r =&gt; String -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ %s }&quot;</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">-- Join two maybe conditions into single one using Y.And if at least one is just.</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><a href="#local-6989586621679234510"><span class="hs-identifier hs-type">joinedConditions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Yaml.html#Condition"><span class="hs-identifier hs-type">Y.Condition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Yaml.html#Condition"><span class="hs-identifier hs-type">Y.Condition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Yaml.html#Condition"><span class="hs-identifier hs-type">Y.Condition</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621679234510"><span class="annot"><span class="annottext">joinedConditions :: Maybe Condition -&gt; Maybe Condition -&gt; Maybe Condition
</span><a href="#local-6989586621679234510"><span class="hs-identifier hs-var hs-var">joinedConditions</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Condition
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="#local-6989586621679234510"><span class="hs-identifier hs-var">joinedConditions</span></a></span><span> </span><span id="local-6989586621679234532"><span class="annot"><span class="annottext">first :: Maybe Condition
</span><a href="#local-6989586621679234532"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Condition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679234532"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="#local-6989586621679234510"><span class="hs-identifier hs-var">joinedConditions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679234533"><span class="annot"><span class="annottext">second :: Maybe Condition
</span><a href="#local-6989586621679234533"><span class="hs-identifier hs-var">second</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Condition
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679234533"><span class="hs-identifier hs-var">second</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621679234510"><span class="hs-identifier hs-var">joinedConditions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679234534"><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234534"><span class="hs-identifier hs-var">first</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679234535"><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234535"><span class="hs-identifier hs-var">second</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Condition -&gt; Maybe Condition
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Condition] -&gt; Condition
</span><a href="Yaml.html#And"><span class="hs-identifier hs-var">Y.And</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234534"><span class="hs-identifier hs-var">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679234535"><span class="hs-identifier hs-var">second</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="LaTeX.html#explainRules"><span class="hs-identifier hs-type">explainRules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Yaml.html#Rule"><span class="hs-identifier hs-type">Y.Rule</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-350"></span><span id="explainRules"><span class="annot"><span class="annottext">explainRules :: [Rule] -&gt; String
</span><a href="LaTeX.html#explainRules"><span class="hs-identifier hs-var hs-var">explainRules</span></a></span></span><span> </span><span id="local-6989586621679234537"><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679234537"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\begin{tabular}{rl}&quot;</span></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rule -&gt; String) -&gt; [Rule] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Rule -&gt; String
</span><a href="LaTeX.html#explainRule"><span class="hs-identifier hs-var">explainRule</span></a></span><span> </span><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679234537"><span class="hs-identifier hs-var">rules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\end{tabular}&quot;</span></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-357"></span></pre></body></html>