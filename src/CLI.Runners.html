<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- SPDX-FileCopyrightText: Copyright (c) 2025 Objectionary.com</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- SPDX-License-Identifier: MIT</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CLI.Runners</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CLI.Helpers.html"><span class="hs-identifier">CLI.Helpers</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CLI.Types.html"><span class="hs-identifier">CLI.Types</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="CLI.Validators.html"><span class="hs-identifier">CLI.Validators</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Canonizer.html"><span class="hs-identifier">Canonizer</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Condition.html"><span class="hs-identifier">Condition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Condition.html#parseConditionThrows"><span class="hs-identifier">parseConditionThrows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Dataize.html"><span class="hs-identifier">Dataize</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Encoding.html"><span class="hs-identifier">Encoding</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Filter.html"><span class="hs-identifier">Filter</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Functions.html"><span class="hs-identifier">Functions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Functions.html#buildTerm"><span class="hs-identifier">buildTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="LaTeX.html"><span class="hs-identifier">LaTeX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="LaTeX.html#explainRules"><span class="hs-identifier">explainRules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Logger.html"><span class="hs-identifier">Logger</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Margin.html"><span class="hs-identifier">Margin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Margin.html#defaultMargin"><span class="hs-identifier">defaultMargin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Merge.html"><span class="hs-identifier">Merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Merge.html#merge"><span class="hs-identifier">merge</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parser.html"><span class="hs-identifier">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.html#parseExpressionThrows"><span class="hs-identifier">parseExpressionThrows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Printer.html"><span class="hs-identifier">Printer</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rewriter.html"><span class="hs-identifier">Rewriter</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rule.html"><span class="hs-identifier">Rule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Rule.html#RuleContext"><span class="hs-identifier">RuleContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rule.html#matchProgramWithRule"><span class="hs-identifier">matchProgramWithRule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMIR.html"><span class="hs-identifier">XMIR</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Yaml.html"><span class="hs-identifier">Yaml</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Y</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="CLI.Runners.html#runRewrite"><span class="hs-identifier hs-type">runRewrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CLI.Types.html#OptsRewrite"><span class="hs-identifier hs-type">OptsRewrite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span id="runRewrite"><span class="annot"><span class="annottext">runRewrite :: OptsRewrite -&gt; IO ()
</span><a href="CLI.Runners.html#runRewrite"><span class="hs-identifier hs-var hs-var">runRewrite</span></a></span></span><span> </span><span class="annot"><a href="CLI.Types.html#OptsRewrite"><span class="hs-identifier hs-type">OptsRewrite</span></a></span><span class="hs-special">{</span><span id="local-6989586621679235610"><span id="local-6989586621679235611"><span id="local-6989586621679235612"><span id="local-6989586621679235613"><span id="local-6989586621679235614"><span id="local-6989586621679235615"><span id="local-6989586621679235616"><span id="local-6989586621679235617"><span id="local-6989586621679235618"><span id="local-6989586621679235619"><span id="local-6989586621679235620"><span id="local-6989586621679235621"><span id="local-6989586621679235622"><span id="local-6989586621679235623"><span id="local-6989586621679235624"><span id="local-6989586621679235625"><span id="local-6989586621679235626"><span id="local-6989586621679235627"><span id="local-6989586621679235628"><span id="local-6989586621679235629"><span id="local-6989586621679235630"><span id="local-6989586621679235631"><span id="local-6989586621679235632"><span id="local-6989586621679235633"><span id="local-6989586621679235634"><span id="local-6989586621679235635"><span id="local-6989586621679235636"><span id="local-6989586621679235637"><span id="local-6989586621679235638"><span id="local-6989586621679235639"><span id="local-6989586621679235640"><span id="local-6989586621679235641"><span id="local-6989586621679235642"><span class="annot"><span class="annottext">Bool
Int
FilePath
[FilePath]
Maybe Int
Maybe FilePath
LogLevel
Must
SugarType
LineFormat
IOFormat
_logLevel :: LogLevel
_logLines :: Int
_inputFormat :: IOFormat
_outputFormat :: IOFormat
_sugarType :: SugarType
_flat :: LineFormat
_must :: Must
_normalize :: Bool
_shuffle :: Bool
_omitListing :: Bool
_omitComments :: Bool
_depthSensitive :: Bool
_nonumber :: Bool
_inPlace :: Bool
_sequence :: Bool
_canonize :: Bool
_compress :: Bool
_maxDepth :: Int
_maxCycles :: Int
_margin :: Int
_meetPopularity :: Maybe Int
_meetLength :: Maybe Int
_rules :: [FilePath]
_hide :: [FilePath]
_show :: [FilePath]
_locator :: FilePath
_focus :: FilePath
_expression :: Maybe FilePath
_label :: Maybe FilePath
_meetPrefix :: Maybe FilePath
_targetFile :: Maybe FilePath
_stepsDir :: Maybe FilePath
_inputFile :: Maybe FilePath
$sel:_logLevel:OptsRewrite :: OptsRewrite -&gt; LogLevel
$sel:_logLines:OptsRewrite :: OptsRewrite -&gt; Int
$sel:_inputFormat:OptsRewrite :: OptsRewrite -&gt; IOFormat
$sel:_outputFormat:OptsRewrite :: OptsRewrite -&gt; IOFormat
$sel:_sugarType:OptsRewrite :: OptsRewrite -&gt; SugarType
$sel:_flat:OptsRewrite :: OptsRewrite -&gt; LineFormat
$sel:_must:OptsRewrite :: OptsRewrite -&gt; Must
$sel:_normalize:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_shuffle:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_omitListing:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_omitComments:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_depthSensitive:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_nonumber:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_inPlace:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_sequence:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_canonize:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_compress:OptsRewrite :: OptsRewrite -&gt; Bool
$sel:_maxDepth:OptsRewrite :: OptsRewrite -&gt; Int
$sel:_maxCycles:OptsRewrite :: OptsRewrite -&gt; Int
$sel:_margin:OptsRewrite :: OptsRewrite -&gt; Int
$sel:_meetPopularity:OptsRewrite :: OptsRewrite -&gt; Maybe Int
$sel:_meetLength:OptsRewrite :: OptsRewrite -&gt; Maybe Int
$sel:_rules:OptsRewrite :: OptsRewrite -&gt; [FilePath]
$sel:_hide:OptsRewrite :: OptsRewrite -&gt; [FilePath]
$sel:_show:OptsRewrite :: OptsRewrite -&gt; [FilePath]
$sel:_locator:OptsRewrite :: OptsRewrite -&gt; FilePath
$sel:_focus:OptsRewrite :: OptsRewrite -&gt; FilePath
$sel:_expression:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
$sel:_label:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
$sel:_meetPrefix:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
$sel:_targetFile:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
$sel:_stepsDir:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
$sel:_inputFile:OptsRewrite :: OptsRewrite -&gt; Maybe FilePath
</span><a href="#local-6989586621679235610"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679235676"><span class="hs-identifier hs-var">validateOpts</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span id="local-6989586621679235677"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235677"><span class="hs-identifier hs-var">excluded</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hide&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235633"><span class="hs-identifier hs-var">_hide</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span id="local-6989586621679235679"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235679"><span class="hs-identifier hs-var">included</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;show&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235634"><span class="hs-identifier hs-var">_show</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679235680"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235680"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;locator&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235635"><span class="hs-identifier hs-var">_locator</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679235681"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235681"><span class="hs-identifier hs-var">foc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;focus&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235636"><span class="hs-identifier hs-var">_focus</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Int -&gt; Int -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Amount of rewriting cycles across all the rules: %d, per rule: %d&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235628"><span class="hs-identifier hs-var">_maxCycles</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235627"><span class="hs-identifier hs-var">_maxDepth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679235683"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235683"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO FilePath
</span><a href="CLI.Helpers.html#readInput"><span class="hs-identifier hs-var">readInput</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235642"><span class="hs-identifier hs-var">_inputFile</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679235685"><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679235685"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; [FilePath] -&gt; IO [Rule]
</span><a href="CLI.Helpers.html#getRules"><span class="hs-identifier hs-var">getRules</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235617"><span class="hs-identifier hs-var">_normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235618"><span class="hs-identifier hs-var">_shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235632"><span class="hs-identifier hs-var">_rules</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679235687"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235687"><span class="hs-identifier hs-var">program</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOFormat -&gt; IO Program
</span><a href="CLI.Helpers.html#parseProgram"><span class="hs-identifier hs-var">parseProgram</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235683"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235612"><span class="hs-identifier hs-var">_inputFormat</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679235690"><span class="annot"><span class="annottext">listing :: Program -&gt; FilePath
</span><a href="#local-6989586621679235690"><span class="hs-identifier hs-var hs-var">listing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Rule] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679235685"><span class="hs-identifier hs-var">rules</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Program -&gt; FilePath
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235683"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679235693"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235693"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Program -&gt; PrintConfig -&gt; FilePath
</span><a href="Printer.html#printProgram%27"><span class="hs-identifier hs-var">P.printProgram'</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235693"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235614"><span class="hs-identifier hs-var">_sugarType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="Encoding.html#UNICODE"><span class="hs-identifier hs-var">UNICODE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235615"><span class="hs-identifier hs-var">_flat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235629"><span class="hs-identifier hs-var">_margin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>      </span><span id="local-6989586621679235696"><span class="annot"><span class="annottext">xmirCtx :: XmirContext
</span><a href="#local-6989586621679235696"><span class="hs-identifier hs-var hs-var">xmirCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; (Program -&gt; FilePath) -&gt; XmirContext
</span><a href="XMIR.html#XmirContext"><span class="hs-identifier hs-var">XmirContext</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235619"><span class="hs-identifier hs-var">_omitListing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235620"><span class="hs-identifier hs-var">_omitComments</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; FilePath
</span><a href="#local-6989586621679235690"><span class="hs-identifier hs-var">listing</span></a></span><span>
</span><span id="line-47"></span><span>      </span><span id="local-6989586621679235698"><span class="annot"><span class="annottext">printCtx :: PrintProgramContext
</span><a href="#local-6989586621679235698"><span class="hs-identifier hs-var hs-var">printCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XmirContext -&gt; Expression -&gt; PrintProgramContext
</span><a href="#local-6989586621679235699"><span class="hs-identifier hs-var">printProgCtx</span></a></span><span> </span><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235696"><span class="hs-identifier hs-var">xmirCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235681"><span class="hs-identifier hs-var">foc</span></a></span><span>
</span><span id="line-48"></span><span>      </span><span id="local-6989586621679235700"><span class="annot"><span class="annottext">canonize :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235700"><span class="hs-identifier hs-var hs-var">canonize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235625"><span class="hs-identifier hs-var">_canonize</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="Canonizer.html#canonize"><span class="hs-identifier hs-var">C.canonize</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-49"></span><span>      </span><span id="local-6989586621679235703"><span class="annot"><span class="annottext">exclude :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235703"><span class="hs-identifier hs-var hs-var">exclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Expression] -&gt; [Rewritten]
</span><a href="Filter.html#exclude"><span class="hs-operator hs-var">`F.exclude`</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235677"><span class="hs-identifier hs-var">excluded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>      </span><span id="local-6989586621679235705"><span class="annot"><span class="annottext">include :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235705"><span class="hs-identifier hs-var hs-var">include</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Expression] -&gt; [Rewritten]
</span><a href="Filter.html#include"><span class="hs-operator hs-var">`F.include`</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235679"><span class="hs-identifier hs-var">included</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679235707"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235707"><span class="hs-identifier hs-var">rewrittens</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679235708"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235708"><span class="hs-identifier hs-var">exceeded</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Program -&gt; [Rule] -&gt; RewriteContext -&gt; IO ([Rewritten], Bool)
</span><a href="Rewriter.html#rewrite"><span class="hs-identifier hs-var">rewrite</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235687"><span class="hs-identifier hs-var">program</span></a></span><span> </span><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679235685"><span class="hs-identifier hs-var">rules</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; PrintProgramContext -&gt; RewriteContext
</span><a href="#local-6989586621679235710"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235680"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235698"><span class="hs-identifier hs-var">printCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679235713"><span class="annot"><span class="annottext">rewrittens' :: [Rewritten]
</span><a href="#local-6989586621679235713"><span class="hs-identifier hs-var hs-var">rewrittens'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235700"><span class="hs-identifier hs-var">canonize</span></a></span><span> </span><span class="annot"><span class="annottext">([Rewritten] -&gt; [Rewritten]) -&gt; [Rewritten] -&gt; [Rewritten]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235703"><span class="hs-identifier hs-var">exclude</span></a></span><span> </span><span class="annot"><span class="annottext">([Rewritten] -&gt; [Rewritten]) -&gt; [Rewritten] -&gt; [Rewritten]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235705"><span class="hs-identifier hs-var">include</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235624"><span class="hs-identifier hs-var">_sequence</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235707"><span class="hs-identifier hs-var">rewrittens</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Rewritten] -&gt; Rewritten
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235707"><span class="hs-identifier hs-var">rewrittens</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Printing rewritten &#120593;-program as %s&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IOFormat -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235613"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679235716"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235716"><span class="hs-identifier hs-var">progs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrintProgramContext -&gt; ([Rewritten], Bool) -&gt; IO FilePath
</span><a href="CLI.Helpers.html#printRewrittens"><span class="hs-identifier hs-var">printRewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235698"><span class="hs-identifier hs-var">printCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235713"><span class="hs-identifier hs-var">rewrittens'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235708"><span class="hs-identifier hs-var">exceeded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>  </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; FilePath -&gt; IO ()
</span><a href="#local-6989586621679235718"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235640"><span class="hs-identifier hs-var">_targetFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235716"><span class="hs-identifier hs-var">progs</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="#local-6989586621679235676"><span class="hs-identifier hs-type">validateOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621679235676"><span class="annot"><span class="annottext">validateOpts :: IO ()
</span><a href="#local-6989586621679235676"><span class="hs-identifier hs-var hs-var">validateOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235623"><span class="hs-identifier hs-var">_inPlace</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235642"><span class="hs-identifier hs-var">_inputFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="CLI.Validators.html#invalidCLIArguments"><span class="hs-identifier hs-var">invalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option --in-place requires an input file&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235623"><span class="hs-identifier hs-var">_inPlace</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235640"><span class="hs-identifier hs-var">_targetFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="CLI.Validators.html#invalidCLIArguments"><span class="hs-identifier hs-var">invalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The options --in-place and --target cannot be used together&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235634"><span class="hs-identifier hs-var">_show</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="CLI.Validators.html#invalidCLIArguments"><span class="hs-identifier hs-var">invalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option --show can be used only once&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="annottext">IOFormat
-&gt; [(Bool, FilePath)]
-&gt; [(Maybe FilePath, FilePath)]
-&gt; [(Maybe Int, FilePath)]
-&gt; IO ()
</span><a href="CLI.Validators.html#validateLatexOptions"><span class="hs-identifier hs-var">validateLatexOptions</span></a></span><span>
</span><span id="line-63"></span><span>        </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235613"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span>
</span><span id="line-64"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235622"><span class="hs-identifier hs-var">_nonumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;nonumber&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235626"><span class="hs-identifier hs-var">_compress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compress&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235637"><span class="hs-identifier hs-var">_expression</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;expression&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235638"><span class="hs-identifier hs-var">_label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235639"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-prefix&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235630"><span class="hs-identifier hs-var">_meetPopularity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-popularity&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235631"><span class="hs-identifier hs-var">_meetLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-length&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="annottext">Must -&gt; IO ()
</span><a href="CLI.Validators.html#validateMust%27"><span class="hs-identifier hs-var">validateMust'</span></a></span><span> </span><span class="annot"><span class="annottext">Must
</span><a href="#local-6989586621679235616"><span class="hs-identifier hs-var">_must</span></a></span><span>
</span><span id="line-68"></span><span>      </span><span class="annot"><span class="annottext">IOFormat -&gt; [(Bool, FilePath)] -&gt; FilePath -&gt; IO ()
</span><a href="CLI.Validators.html#validateXmirOptions"><span class="hs-identifier hs-var">validateXmirOptions</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235613"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235619"><span class="hs-identifier hs-var">_omitListing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-listing&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235620"><span class="hs-identifier hs-var">_omitComments</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-comments&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235636"><span class="hs-identifier hs-var">_focus</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="#local-6989586621679235718"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span id="local-6989586621679235718"><span class="annot"><span class="annottext">output :: Maybe FilePath -&gt; FilePath -&gt; IO ()
</span><a href="#local-6989586621679235718"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span id="local-6989586621679235726"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235726"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679235727"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235727"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235623"><span class="hs-identifier hs-var">_inPlace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235726"><span class="hs-identifier hs-var">target</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235642"><span class="hs-identifier hs-var">_inputFile</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679235728"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235728"><span class="hs-identifier hs-var">file</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option '--in-place' is specified, writing back to '%s'...&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235728"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235728"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235727"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The file '%s' was modified in-place&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235728"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option --in-place requires an input file&quot;</span></span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679235731"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235731"><span class="hs-identifier hs-var">file</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option '--target' is specified, printing to '%s'...&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235731"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235731"><span class="hs-identifier hs-var">file</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235727"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall r. PrintfType r =&gt; FilePath -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The command result was saved in '%s'&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235731"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option '--target' is not specified, printing to console...&quot;</span></span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235727"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="#local-6989586621679235710"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CLI.Types.html#PrintProgramContext"><span class="hs-identifier hs-type">PrintProgramContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Rewriter.html#RewriteContext"><span class="hs-identifier hs-type">RewriteContext</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621679235710"><span class="annot"><span class="annottext">context :: Expression -&gt; PrintProgramContext -&gt; RewriteContext
</span><a href="#local-6989586621679235710"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span id="local-6989586621679235733"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235733"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679235734"><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235734"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression
-&gt; Int
-&gt; Int
-&gt; Bool
-&gt; BuildTermFunc
-&gt; Must
-&gt; SaveStepFunc
-&gt; RewriteContext
</span><a href="Rewriter.html#RewriteContext"><span class="hs-identifier hs-var">RewriteContext</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235733"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235627"><span class="hs-identifier hs-var">_maxDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235628"><span class="hs-identifier hs-var">_maxCycles</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235621"><span class="hs-identifier hs-var">_depthSensitive</span></a></span><span> </span><span class="annot"><span class="annottext">BuildTermFunc
</span><a href="Functions.html#buildTerm"><span class="hs-identifier hs-var">buildTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Must
</span><a href="#local-6989586621679235616"><span class="hs-identifier hs-var">_must</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath -&gt; PrintProgramContext -&gt; SaveStepFunc
</span><a href="CLI.Helpers.html#saveStepFunc"><span class="hs-identifier hs-var">saveStepFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235641"><span class="hs-identifier hs-var">_stepsDir</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235734"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679235699"><span class="hs-identifier hs-type">printProgCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMIR.html#XmirContext"><span class="hs-identifier hs-type">XmirContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CLI.Types.html#PrintProgramContext"><span class="hs-identifier hs-type">PrintProgramContext</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621679235699"><span class="annot"><span class="annottext">printProgCtx :: XmirContext -&gt; Expression -&gt; PrintProgramContext
</span><a href="#local-6989586621679235699"><span class="hs-identifier hs-var hs-var">printProgCtx</span></a></span></span><span> </span><span id="local-6989586621679235737"><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235737"><span class="hs-identifier hs-var">xmirCtx</span></a></span></span><span> </span><span id="local-6989586621679235738"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235738"><span class="hs-identifier hs-var">focus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>      </span><span class="annot"><span class="annottext">SugarType
-&gt; LineFormat
-&gt; Int
-&gt; XmirContext
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; Int
-&gt; Int
-&gt; Expression
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; IOFormat
-&gt; PrintProgramContext
</span><a href="CLI.Types.html#PrintProgCtx"><span class="hs-identifier hs-var">PrintProgCtx</span></a></span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235614"><span class="hs-identifier hs-var">_sugarType</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235615"><span class="hs-identifier hs-var">_flat</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235629"><span class="hs-identifier hs-var">_margin</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235737"><span class="hs-identifier hs-var">xmirCtx</span></a></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235622"><span class="hs-identifier hs-var">_nonumber</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235626"><span class="hs-identifier hs-var">_compress</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235624"><span class="hs-identifier hs-var">_sequence</span></a></span><span>
</span><span id="line-96"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetPopularity"><span class="hs-identifier hs-var">justMeetPopularity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235630"><span class="hs-identifier hs-var">_meetPopularity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetLength"><span class="hs-identifier hs-var">justMeetLength</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235631"><span class="hs-identifier hs-var">_meetLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235738"><span class="hs-identifier hs-var">focus</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235637"><span class="hs-identifier hs-var">_expression</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235638"><span class="hs-identifier hs-var">_label</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235639"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235613"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="CLI.Runners.html#runDataize"><span class="hs-identifier hs-type">runDataize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CLI.Types.html#OptsDataize"><span class="hs-identifier hs-type">OptsDataize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span id="runDataize"><span class="annot"><span class="annottext">runDataize :: OptsDataize -&gt; IO ()
</span><a href="CLI.Runners.html#runDataize"><span class="hs-identifier hs-var hs-var">runDataize</span></a></span></span><span> </span><span class="annot"><a href="CLI.Types.html#OptsDataize"><span class="hs-identifier hs-type">OptsDataize</span></a></span><span class="hs-special">{</span><span id="local-6989586621679235744"><span id="local-6989586621679235745"><span id="local-6989586621679235746"><span id="local-6989586621679235747"><span id="local-6989586621679235748"><span id="local-6989586621679235749"><span id="local-6989586621679235750"><span id="local-6989586621679235751"><span id="local-6989586621679235752"><span id="local-6989586621679235753"><span id="local-6989586621679235754"><span id="local-6989586621679235755"><span id="local-6989586621679235756"><span id="local-6989586621679235757"><span id="local-6989586621679235758"><span id="local-6989586621679235759"><span id="local-6989586621679235760"><span id="local-6989586621679235761"><span id="local-6989586621679235762"><span id="local-6989586621679235763"><span id="local-6989586621679235764"><span id="local-6989586621679235765"><span id="local-6989586621679235766"><span id="local-6989586621679235767"><span id="local-6989586621679235768"><span id="local-6989586621679235769"><span id="local-6989586621679235770"><span id="local-6989586621679235771"><span class="annot"><span class="annottext">Bool
Int
FilePath
[FilePath]
Maybe Int
Maybe FilePath
LogLevel
SugarType
LineFormat
IOFormat
_logLevel :: LogLevel
_logLines :: Int
_inputFormat :: IOFormat
_outputFormat :: IOFormat
_sugarType :: SugarType
_flat :: LineFormat
_omitListing :: Bool
_omitComments :: Bool
_nonumber :: Bool
_sequence :: Bool
_canonize :: Bool
_depthSensitive :: Bool
_quiet :: Bool
_compress :: Bool
_maxDepth :: Int
_maxCycles :: Int
_margin :: Int
_meetPopularity :: Maybe Int
_meetLength :: Maybe Int
_hide :: [FilePath]
_show :: [FilePath]
_locator :: FilePath
_focus :: FilePath
_expression :: Maybe FilePath
_label :: Maybe FilePath
_meetPrefix :: Maybe FilePath
_stepsDir :: Maybe FilePath
_inputFile :: Maybe FilePath
$sel:_logLevel:OptsDataize :: OptsDataize -&gt; LogLevel
$sel:_logLines:OptsDataize :: OptsDataize -&gt; Int
$sel:_inputFormat:OptsDataize :: OptsDataize -&gt; IOFormat
$sel:_outputFormat:OptsDataize :: OptsDataize -&gt; IOFormat
$sel:_sugarType:OptsDataize :: OptsDataize -&gt; SugarType
$sel:_flat:OptsDataize :: OptsDataize -&gt; LineFormat
$sel:_omitListing:OptsDataize :: OptsDataize -&gt; Bool
$sel:_omitComments:OptsDataize :: OptsDataize -&gt; Bool
$sel:_nonumber:OptsDataize :: OptsDataize -&gt; Bool
$sel:_sequence:OptsDataize :: OptsDataize -&gt; Bool
$sel:_canonize:OptsDataize :: OptsDataize -&gt; Bool
$sel:_depthSensitive:OptsDataize :: OptsDataize -&gt; Bool
$sel:_quiet:OptsDataize :: OptsDataize -&gt; Bool
$sel:_compress:OptsDataize :: OptsDataize -&gt; Bool
$sel:_maxDepth:OptsDataize :: OptsDataize -&gt; Int
$sel:_maxCycles:OptsDataize :: OptsDataize -&gt; Int
$sel:_margin:OptsDataize :: OptsDataize -&gt; Int
$sel:_meetPopularity:OptsDataize :: OptsDataize -&gt; Maybe Int
$sel:_meetLength:OptsDataize :: OptsDataize -&gt; Maybe Int
$sel:_hide:OptsDataize :: OptsDataize -&gt; [FilePath]
$sel:_show:OptsDataize :: OptsDataize -&gt; [FilePath]
$sel:_locator:OptsDataize :: OptsDataize -&gt; FilePath
$sel:_focus:OptsDataize :: OptsDataize -&gt; FilePath
$sel:_expression:OptsDataize :: OptsDataize -&gt; Maybe FilePath
$sel:_label:OptsDataize :: OptsDataize -&gt; Maybe FilePath
$sel:_meetPrefix:OptsDataize :: OptsDataize -&gt; Maybe FilePath
$sel:_stepsDir:OptsDataize :: OptsDataize -&gt; Maybe FilePath
$sel:_inputFile:OptsDataize :: OptsDataize -&gt; Maybe FilePath
</span><a href="#local-6989586621679235744"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679235800"><span class="hs-identifier hs-var">validateOpts</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679235801"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235801"><span class="hs-identifier hs-var">excluded</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hide&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235763"><span class="hs-identifier hs-var">_hide</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621679235802"><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235802"><span class="hs-identifier hs-var">included</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;show&quot;</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235764"><span class="hs-identifier hs-var">_show</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679235803"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235803"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;locator&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235765"><span class="hs-identifier hs-var">_locator</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679235804"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235804"><span class="hs-identifier hs-var">foc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; IO [Expression]
</span><a href="CLI.Validators.html#validatedDispatches"><span class="hs-identifier hs-var">validatedDispatches</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;focus&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235766"><span class="hs-identifier hs-var">_focus</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679235805"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235805"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO FilePath
</span><a href="CLI.Helpers.html#readInput"><span class="hs-identifier hs-var">readInput</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235771"><span class="hs-identifier hs-var">_inputFile</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span id="local-6989586621679235806"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235806"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOFormat -&gt; IO Program
</span><a href="CLI.Helpers.html#parseProgram"><span class="hs-identifier hs-var">parseProgram</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235805"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235746"><span class="hs-identifier hs-var">_inputFormat</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679235807"><span class="annot"><span class="annottext">printCtx :: PrintProgramContext
</span><a href="#local-6989586621679235807"><span class="hs-identifier hs-var hs-var">printCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; PrintProgramContext
</span><a href="#local-6989586621679235808"><span class="hs-identifier hs-var">printProgCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235804"><span class="hs-identifier hs-var">foc</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span id="local-6989586621679235809"><span class="annot"><span class="annottext">canonize :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235809"><span class="hs-identifier hs-var hs-var">canonize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235754"><span class="hs-identifier hs-var">_canonize</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="Canonizer.html#canonize"><span class="hs-identifier hs-var">C.canonize</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-115"></span><span>      </span><span id="local-6989586621679235810"><span class="annot"><span class="annottext">exclude :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235810"><span class="hs-identifier hs-var hs-var">exclude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Expression] -&gt; [Rewritten]
</span><a href="Filter.html#exclude"><span class="hs-operator hs-var">`F.exclude`</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235801"><span class="hs-identifier hs-var">excluded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>      </span><span id="local-6989586621679235811"><span class="annot"><span class="annottext">include :: [Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235811"><span class="hs-identifier hs-var hs-var">include</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Expression] -&gt; [Rewritten]
</span><a href="Filter.html#include"><span class="hs-operator hs-var">`F.include`</span></a></span><span> </span><span class="annot"><span class="annottext">[Expression]
</span><a href="#local-6989586621679235802"><span class="hs-identifier hs-var">included</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679235812"><span class="annot"><span class="annottext">Maybe Bytes
</span><a href="#local-6989586621679235812"><span class="hs-identifier hs-var">maybeBytes</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679235813"><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235813"><span class="hs-identifier hs-var">chain</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DataizeContext -&gt; IO (Maybe Bytes, [Rewritten])
</span><a href="Dataize.html#dataize"><span class="hs-identifier hs-var">dataize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Program -&gt; PrintProgramContext -&gt; DataizeContext
</span><a href="#local-6989586621679235815"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235803"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235806"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235807"><span class="hs-identifier hs-var">printCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235753"><span class="hs-identifier hs-var">_sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrintProgramContext -&gt; ([Rewritten], Bool) -&gt; IO FilePath
</span><a href="CLI.Helpers.html#printRewrittens"><span class="hs-identifier hs-var">printRewrittens</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235807"><span class="hs-identifier hs-var">printCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235809"><span class="hs-identifier hs-var">canonize</span></a></span><span> </span><span class="annot"><span class="annottext">([Rewritten] -&gt; [Rewritten]) -&gt; [Rewritten] -&gt; [Rewritten]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235810"><span class="hs-identifier hs-var">exclude</span></a></span><span> </span><span class="annot"><span class="annottext">([Rewritten] -&gt; [Rewritten]) -&gt; [Rewritten] -&gt; [Rewritten]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Rewritten] -&gt; [Rewritten]
</span><a href="#local-6989586621679235811"><span class="hs-identifier hs-var">include</span></a></span><span> </span><span class="annot"><span class="annottext">[Rewritten]
</span><a href="#local-6989586621679235813"><span class="hs-identifier hs-var">chain</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; (FilePath -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235756"><span class="hs-identifier hs-var">_quiet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; (Bytes -&gt; FilePath) -&gt; Maybe Bytes -&gt; FilePath
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; FilePath
</span><a href="Printer.html#printExpression"><span class="hs-identifier hs-var">P.printExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExTermination"><span class="hs-identifier hs-var">ExTermination</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; FilePath
</span><a href="Printer.html#printBytes"><span class="hs-identifier hs-var">P.printBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bytes
</span><a href="#local-6989586621679235812"><span class="hs-identifier hs-var">maybeBytes</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="#local-6989586621679235800"><span class="hs-identifier hs-type">validateOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679235800"><span class="annot"><span class="annottext">validateOpts :: IO ()
</span><a href="#local-6989586621679235800"><span class="hs-identifier hs-var hs-var">validateOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><span class="annottext">IOFormat
-&gt; [(Bool, FilePath)]
-&gt; [(Maybe FilePath, FilePath)]
-&gt; [(Maybe Int, FilePath)]
-&gt; IO ()
</span><a href="CLI.Validators.html#validateLatexOptions"><span class="hs-identifier hs-var">validateLatexOptions</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235747"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235752"><span class="hs-identifier hs-var">_nonumber</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;nonumber&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235757"><span class="hs-identifier hs-var">_compress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;compress&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235767"><span class="hs-identifier hs-var">_expression</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;expression&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235768"><span class="hs-identifier hs-var">_label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;label&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235769"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-prefix&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235761"><span class="hs-identifier hs-var">_meetPopularity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-popularity&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235762"><span class="hs-identifier hs-var">_meetLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;meet-length&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">IOFormat -&gt; [(Bool, FilePath)] -&gt; FilePath -&gt; IO ()
</span><a href="CLI.Validators.html#validateXmirOptions"><span class="hs-identifier hs-var">validateXmirOptions</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235747"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235750"><span class="hs-identifier hs-var">_omitListing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-listing&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235751"><span class="hs-identifier hs-var">_omitComments</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-comments&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235766"><span class="hs-identifier hs-var">_focus</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235764"><span class="hs-identifier hs-var">_show</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="CLI.Validators.html#invalidCLIArguments"><span class="hs-identifier hs-var">invalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The option --show can be used only once&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="#local-6989586621679235815"><span class="hs-identifier hs-type">context</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CLI.Types.html#PrintProgramContext"><span class="hs-identifier hs-type">PrintProgramContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Dataize.html#DataizeContext"><span class="hs-identifier hs-type">DataizeContext</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621679235815"><span class="annot"><span class="annottext">context :: Expression -&gt; Program -&gt; PrintProgramContext -&gt; DataizeContext
</span><a href="#local-6989586621679235815"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span id="local-6989586621679235820"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235820"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679235821"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235821"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621679235822"><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235822"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expression
-&gt; Program
-&gt; Int
-&gt; Int
-&gt; Bool
-&gt; BuildTermFunc
-&gt; SaveStepFunc
-&gt; DataizeContext
</span><a href="Dataize.html#DataizeContext"><span class="hs-identifier hs-var">DataizeContext</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235820"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235821"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235758"><span class="hs-identifier hs-var">_maxDepth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235759"><span class="hs-identifier hs-var">_maxCycles</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235755"><span class="hs-identifier hs-var">_depthSensitive</span></a></span><span> </span><span class="annot"><span class="annottext">BuildTermFunc
</span><a href="Functions.html#buildTerm"><span class="hs-identifier hs-var">buildTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath -&gt; PrintProgramContext -&gt; SaveStepFunc
</span><a href="CLI.Helpers.html#saveStepFunc"><span class="hs-identifier hs-var">saveStepFunc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235770"><span class="hs-identifier hs-var">_stepsDir</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235822"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679235808"><span class="hs-identifier hs-type">printProgCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CLI.Types.html#PrintProgramContext"><span class="hs-identifier hs-type">PrintProgramContext</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679235808"><span class="annot"><span class="annottext">printProgCtx :: Expression -&gt; PrintProgramContext
</span><a href="#local-6989586621679235808"><span class="hs-identifier hs-var hs-var">printProgCtx</span></a></span></span><span> </span><span id="local-6989586621679235824"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235824"><span class="hs-identifier hs-var">focus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>      </span><span class="annot"><span class="annottext">SugarType
-&gt; LineFormat
-&gt; Int
-&gt; XmirContext
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; Int
-&gt; Int
-&gt; Expression
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; IOFormat
-&gt; PrintProgramContext
</span><a href="CLI.Types.html#PrintProgCtx"><span class="hs-identifier hs-var">PrintProgCtx</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235748"><span class="hs-identifier hs-var">_sugarType</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235749"><span class="hs-identifier hs-var">_flat</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235760"><span class="hs-identifier hs-var">_margin</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">XmirContext
</span><a href="XMIR.html#defaultXmirContext"><span class="hs-identifier hs-var">defaultXmirContext</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235752"><span class="hs-identifier hs-var">_nonumber</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235757"><span class="hs-identifier hs-var">_compress</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235753"><span class="hs-identifier hs-var">_sequence</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetPopularity"><span class="hs-identifier hs-var">justMeetPopularity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235761"><span class="hs-identifier hs-var">_meetPopularity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetLength"><span class="hs-identifier hs-var">justMeetLength</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679235762"><span class="hs-identifier hs-var">_meetLength</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235824"><span class="hs-identifier hs-var">focus</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235767"><span class="hs-identifier hs-var">_expression</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235768"><span class="hs-identifier hs-var">_label</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235769"><span class="hs-identifier hs-var">_meetPrefix</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235747"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="CLI.Runners.html#runExplain"><span class="hs-identifier hs-type">runExplain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CLI.Types.html#OptsExplain"><span class="hs-identifier hs-type">OptsExplain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="runExplain"><span class="annot"><span class="annottext">runExplain :: OptsExplain -&gt; IO ()
</span><a href="CLI.Runners.html#runExplain"><span class="hs-identifier hs-var hs-var">runExplain</span></a></span></span><span> </span><span class="annot"><a href="CLI.Types.html#OptsExplain"><span class="hs-identifier hs-type">OptsExplain</span></a></span><span class="hs-special">{</span><span id="local-6989586621679235828"><span id="local-6989586621679235829"><span id="local-6989586621679235830"><span id="local-6989586621679235831"><span id="local-6989586621679235832"><span id="local-6989586621679235833"><span class="annot"><span class="annottext">Bool
Int
[FilePath]
Maybe FilePath
LogLevel
_logLevel :: LogLevel
_logLines :: Int
_rules :: [FilePath]
_normalize :: Bool
_shuffle :: Bool
_targetFile :: Maybe FilePath
$sel:_logLevel:OptsExplain :: OptsExplain -&gt; LogLevel
$sel:_logLines:OptsExplain :: OptsExplain -&gt; Int
$sel:_rules:OptsExplain :: OptsExplain -&gt; [FilePath]
$sel:_normalize:OptsExplain :: OptsExplain -&gt; Bool
$sel:_shuffle:OptsExplain :: OptsExplain -&gt; Bool
$sel:_targetFile:OptsExplain :: OptsExplain -&gt; Maybe FilePath
</span><a href="#local-6989586621679235828"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679235840"><span class="hs-identifier hs-var">validateOpts</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679235841"><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679235841"><span class="hs-identifier hs-var">rules</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; [FilePath] -&gt; IO [Rule]
</span><a href="CLI.Helpers.html#getRules"><span class="hs-identifier hs-var">getRules</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235831"><span class="hs-identifier hs-var">_normalize</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235832"><span class="hs-identifier hs-var">_shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235830"><span class="hs-identifier hs-var">_rules</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; FilePath -&gt; IO ()
</span><a href="CLI.Helpers.html#printOut"><span class="hs-identifier hs-var">printOut</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235833"><span class="hs-identifier hs-var">_targetFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Rule] -&gt; FilePath
</span><a href="LaTeX.html#explainRules"><span class="hs-identifier hs-var">explainRules</span></a></span><span> </span><span class="annot"><span class="annottext">[Rule]
</span><a href="#local-6989586621679235841"><span class="hs-identifier hs-var">rules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679235840"><span class="hs-identifier hs-type">validateOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679235840"><span class="annot"><span class="annottext">validateOpts :: IO ()
</span><a href="#local-6989586621679235840"><span class="hs-identifier hs-var hs-var">validateOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235830"><span class="hs-identifier hs-var">_rules</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235831"><span class="hs-identifier hs-var">_normalize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
forall a. FilePath -&gt; IO a
</span><a href="CLI.Validators.html#invalidCLIArguments"><span class="hs-identifier hs-var">invalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Either --rule or --normalize must be specified&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="CLI.Runners.html#runMerge"><span class="hs-identifier hs-type">runMerge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CLI.Types.html#OptsMerge"><span class="hs-identifier hs-type">OptsMerge</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="runMerge"><span class="annot"><span class="annottext">runMerge :: OptsMerge -&gt; IO ()
</span><a href="CLI.Runners.html#runMerge"><span class="hs-identifier hs-var hs-var">runMerge</span></a></span></span><span> </span><span class="annot"><a href="CLI.Types.html#OptsMerge"><span class="hs-identifier hs-type">OptsMerge</span></a></span><span class="hs-special">{</span><span id="local-6989586621679235846"><span id="local-6989586621679235847"><span id="local-6989586621679235848"><span id="local-6989586621679235849"><span id="local-6989586621679235850"><span id="local-6989586621679235851"><span id="local-6989586621679235852"><span id="local-6989586621679235853"><span id="local-6989586621679235854"><span id="local-6989586621679235855"><span id="local-6989586621679235856"><span class="annot"><span class="annottext">Bool
Int
[FilePath]
Maybe FilePath
LogLevel
SugarType
LineFormat
IOFormat
_logLevel :: LogLevel
_logLines :: Int
_inputFormat :: IOFormat
_outputFormat :: IOFormat
_sugarType :: SugarType
_flat :: LineFormat
_omitListing :: Bool
_omitComments :: Bool
_margin :: Int
_targetFile :: Maybe FilePath
_inputs :: [FilePath]
$sel:_logLevel:OptsMerge :: OptsMerge -&gt; LogLevel
$sel:_logLines:OptsMerge :: OptsMerge -&gt; Int
$sel:_inputFormat:OptsMerge :: OptsMerge -&gt; IOFormat
$sel:_outputFormat:OptsMerge :: OptsMerge -&gt; IOFormat
$sel:_sugarType:OptsMerge :: OptsMerge -&gt; SugarType
$sel:_flat:OptsMerge :: OptsMerge -&gt; LineFormat
$sel:_omitListing:OptsMerge :: OptsMerge -&gt; Bool
$sel:_omitComments:OptsMerge :: OptsMerge -&gt; Bool
$sel:_margin:OptsMerge :: OptsMerge -&gt; Int
$sel:_targetFile:OptsMerge :: OptsMerge -&gt; Maybe FilePath
$sel:_inputs:OptsMerge :: OptsMerge -&gt; [FilePath]
</span><a href="#local-6989586621679235846"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679235868"><span class="hs-identifier hs-var">validateOpts</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679235869"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235869"><span class="hs-identifier hs-var">inputs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; [FilePath] -&gt; IO [FilePath]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO FilePath
</span><a href="CLI.Helpers.html#readInput"><span class="hs-identifier hs-var">readInput</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; IO FilePath)
-&gt; (FilePath -&gt; Maybe FilePath) -&gt; FilePath -&gt; IO FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Maybe FilePath
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235856"><span class="hs-identifier hs-var">_inputs</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621679235872"><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679235872"><span class="hs-identifier hs-var">progs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Program) -&gt; [FilePath] -&gt; IO [Program]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; IOFormat -&gt; IO Program
</span><a href="CLI.Helpers.html#parseProgram"><span class="hs-operator hs-var">`parseProgram`</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235848"><span class="hs-identifier hs-var">_inputFormat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235869"><span class="hs-identifier hs-var">inputs'</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679235873"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235873"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Program] -&gt; IO Program
</span><a href="Merge.html#merge"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">[Program]
</span><a href="#local-6989586621679235872"><span class="hs-identifier hs-var">progs</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679235874"><span class="annot"><span class="annottext">listing :: b -&gt; FilePath
</span><a href="#local-6989586621679235874"><span class="hs-identifier hs-var hs-var">listing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; b -&gt; FilePath
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Program -&gt; PrintConfig -&gt; FilePath
</span><a href="Printer.html#printProgram%27"><span class="hs-identifier hs-var">P.printProgram'</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235873"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235850"><span class="hs-identifier hs-var">_sugarType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="Encoding.html#UNICODE"><span class="hs-identifier hs-var">UNICODE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235851"><span class="hs-identifier hs-var">_flat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235854"><span class="hs-identifier hs-var">_margin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>      </span><span id="local-6989586621679235875"><span class="annot"><span class="annottext">xmirCtx :: XmirContext
</span><a href="#local-6989586621679235875"><span class="hs-identifier hs-var hs-var">xmirCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; (Program -&gt; FilePath) -&gt; XmirContext
</span><a href="XMIR.html#XmirContext"><span class="hs-identifier hs-var">XmirContext</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235852"><span class="hs-identifier hs-var">_omitListing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235853"><span class="hs-identifier hs-var">_omitComments</span></a></span><span> </span><span class="annot"><span class="annottext">Program -&gt; FilePath
forall {b}. b -&gt; FilePath
</span><a href="#local-6989586621679235874"><span class="hs-identifier hs-var">listing</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span id="local-6989586621679235876"><span class="annot"><span class="annottext">printCtx :: PrintProgramContext
</span><a href="#local-6989586621679235876"><span class="hs-identifier hs-var hs-var">printCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XmirContext -&gt; PrintProgramContext
</span><a href="#local-6989586621679235877"><span class="hs-identifier hs-var">printProgCtx</span></a></span><span> </span><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235875"><span class="hs-identifier hs-var">xmirCtx</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679235878"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235878"><span class="hs-identifier hs-var">prog'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PrintProgramContext -&gt; Program -&gt; IO FilePath
</span><a href="CLI.Helpers.html#printProgram"><span class="hs-identifier hs-var">printProgram</span></a></span><span> </span><span class="annot"><span class="annottext">PrintProgramContext
</span><a href="#local-6989586621679235876"><span class="hs-identifier hs-var">printCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235873"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; FilePath -&gt; IO ()
</span><a href="CLI.Helpers.html#printOut"><span class="hs-identifier hs-var">printOut</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235855"><span class="hs-identifier hs-var">_targetFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235878"><span class="hs-identifier hs-var">prog'</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621679235868"><span class="hs-identifier hs-type">validateOpts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span id="local-6989586621679235868"><span class="annot"><span class="annottext">validateOpts :: IO ()
</span><a href="#local-6989586621679235868"><span class="hs-identifier hs-var hs-var">validateOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679235856"><span class="hs-identifier hs-var">_inputs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmdException -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; CmdException
</span><a href="CLI.Types.html#InvalidCLIArguments"><span class="hs-identifier hs-var">InvalidCLIArguments</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;At least one input file must be specified for 'merge' command&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">IOFormat -&gt; [(Bool, FilePath)] -&gt; FilePath -&gt; IO ()
</span><a href="CLI.Validators.html#validateXmirOptions"><span class="hs-identifier hs-var">validateXmirOptions</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235849"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235852"><span class="hs-identifier hs-var">_omitListing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-listing&quot;</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679235853"><span class="hs-identifier hs-var">_omitComments</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;omit-comments&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Q&quot;</span></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="#local-6989586621679235877"><span class="hs-identifier hs-type">printProgCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMIR.html#XmirContext"><span class="hs-identifier hs-type">XmirContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CLI.Types.html#PrintProgramContext"><span class="hs-identifier hs-type">PrintProgramContext</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679235877"><span class="annot"><span class="annottext">printProgCtx :: XmirContext -&gt; PrintProgramContext
</span><a href="#local-6989586621679235877"><span class="hs-identifier hs-var hs-var">printProgCtx</span></a></span></span><span> </span><span id="local-6989586621679235882"><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235882"><span class="hs-identifier hs-var">xmirCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="annottext">SugarType
-&gt; LineFormat
-&gt; Int
-&gt; XmirContext
-&gt; Bool
-&gt; Bool
-&gt; Bool
-&gt; Int
-&gt; Int
-&gt; Expression
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; Maybe FilePath
-&gt; IOFormat
-&gt; PrintProgramContext
</span><a href="CLI.Types.html#PrintProgCtx"><span class="hs-identifier hs-var">PrintProgCtx</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235850"><span class="hs-identifier hs-var">_sugarType</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235851"><span class="hs-identifier hs-var">_flat</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679235854"><span class="hs-identifier hs-var">_margin</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">XmirContext
</span><a href="#local-6989586621679235882"><span class="hs-identifier hs-var">xmirCtx</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetPopularity"><span class="hs-identifier hs-var">justMeetPopularity</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
</span><a href="CLI.Helpers.html#justMeetLength"><span class="hs-identifier hs-var">justMeetLength</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">IOFormat
</span><a href="#local-6989586621679235849"><span class="hs-identifier hs-var">_outputFormat</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="CLI.Runners.html#runMatch"><span class="hs-identifier hs-type">runMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CLI.Types.html#OptsMatch"><span class="hs-identifier hs-type">OptsMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span id="runMatch"><span class="annot"><span class="annottext">runMatch :: OptsMatch -&gt; IO ()
</span><a href="CLI.Runners.html#runMatch"><span class="hs-identifier hs-var hs-var">runMatch</span></a></span></span><span> </span><span class="annot"><a href="CLI.Types.html#OptsMatch"><span class="hs-identifier hs-type">OptsMatch</span></a></span><span class="hs-special">{</span><span id="local-6989586621679235886"><span id="local-6989586621679235887"><span id="local-6989586621679235888"><span id="local-6989586621679235889"><span id="local-6989586621679235890"><span id="local-6989586621679235891"><span id="local-6989586621679235892"><span class="annot"><span class="annottext">Int
Maybe FilePath
LogLevel
SugarType
LineFormat
_logLevel :: LogLevel
_logLines :: Int
_sugarType :: SugarType
_flat :: LineFormat
_pattern :: Maybe FilePath
_when :: Maybe FilePath
_inputFile :: Maybe FilePath
$sel:_logLevel:OptsMatch :: OptsMatch -&gt; LogLevel
$sel:_logLines:OptsMatch :: OptsMatch -&gt; Int
$sel:_sugarType:OptsMatch :: OptsMatch -&gt; SugarType
$sel:_flat:OptsMatch :: OptsMatch -&gt; LineFormat
$sel:_pattern:OptsMatch :: OptsMatch -&gt; Maybe FilePath
$sel:_when:OptsMatch :: OptsMatch -&gt; Maybe FilePath
$sel:_inputFile:OptsMatch :: OptsMatch -&gt; Maybe FilePath
</span><a href="#local-6989586621679235886"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621679235900"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235900"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; IO FilePath
</span><a href="CLI.Helpers.html#readInput"><span class="hs-identifier hs-var">readInput</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235892"><span class="hs-identifier hs-var">_inputFile</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679235901"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235901"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IOFormat -&gt; IO Program
</span><a href="CLI.Helpers.html#parseProgram"><span class="hs-identifier hs-var">parseProgram</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679235900"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IOFormat
</span><a href="CLI.Types.html#PHI"><span class="hs-identifier hs-var">PHI</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235890"><span class="hs-identifier hs-var">_pattern</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;The --pattern is not provided, no substitutions are built&quot;</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>      </span><span id="local-6989586621679235903"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235903"><span class="hs-identifier hs-var">ptn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Expression
</span><a href="Parser.html#parseExpressionThrows"><span class="hs-identifier hs-var">parseExpressionThrows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FilePath -&gt; FilePath
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235890"><span class="hs-identifier hs-var">_pattern</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>      </span><span id="local-6989586621679235904"><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679235904"><span class="hs-identifier hs-var">condition</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Condition)
-&gt; Maybe FilePath -&gt; IO (Maybe Condition)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Condition
</span><a href="Condition.html#parseConditionThrows"><span class="hs-identifier hs-var">parseConditionThrows</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621679235891"><span class="hs-identifier hs-var">_when</span></a></span><span>
</span><span id="line-202"></span><span>      </span><span id="local-6989586621679235905"><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679235905"><span class="hs-identifier hs-var">substs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Program -&gt; Rule -&gt; RuleContext -&gt; IO [Subst]
</span><a href="Rule.html#matchProgramWithRule"><span class="hs-identifier hs-var">matchProgramWithRule</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679235901"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expression -&gt; Maybe Condition -&gt; Rule
</span><a href="#local-6989586621679235906"><span class="hs-identifier hs-var">rule</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235903"><span class="hs-identifier hs-var">ptn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679235904"><span class="hs-identifier hs-var">condition</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuildTermFunc -&gt; RuleContext
</span><a href="Rule.html#RuleContext"><span class="hs-identifier hs-var">RuleContext</span></a></span><span> </span><span class="annot"><span class="annottext">BuildTermFunc
</span><a href="Functions.html#buildTerm"><span class="hs-identifier hs-var">buildTerm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Subst] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679235905"><span class="hs-identifier hs-var">substs</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="Logger.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Provided pattern was not matched, no substitutions are built&quot;</span></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Subst] -&gt; PrintConfig -&gt; FilePath
</span><a href="Printer.html#printSubsts%27"><span class="hs-identifier hs-var">P.printSubsts'</span></a></span><span> </span><span class="annot"><span class="annottext">[Subst]
</span><a href="#local-6989586621679235905"><span class="hs-identifier hs-var">substs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SugarType
</span><a href="#local-6989586621679235888"><span class="hs-identifier hs-var">_sugarType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="Encoding.html#UNICODE"><span class="hs-identifier hs-var">UNICODE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LineFormat
</span><a href="#local-6989586621679235889"><span class="hs-identifier hs-var">_flat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Margin.html#defaultMargin"><span class="hs-identifier hs-var">defaultMargin</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621679235906"><span class="hs-identifier hs-type">rule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Yaml.html#Condition"><span class="hs-identifier hs-type">Y.Condition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Yaml.html#Rule"><span class="hs-identifier hs-type">Y.Rule</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679235906"><span class="annot"><span class="annottext">rule :: Expression -&gt; Maybe Condition -&gt; Rule
</span><a href="#local-6989586621679235906"><span class="hs-identifier hs-var hs-var">rule</span></a></span></span><span> </span><span id="local-6989586621679235909"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235909"><span class="hs-identifier hs-var">ptn</span></a></span></span><span> </span><span id="local-6989586621679235910"><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679235910"><span class="hs-identifier hs-var">cnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
-&gt; Maybe FilePath
-&gt; Expression
-&gt; Expression
-&gt; Maybe Condition
-&gt; Maybe [Extra]
-&gt; Maybe Condition
-&gt; Rule
</span><a href="Yaml.html#Rule"><span class="hs-identifier hs-var">Y.Rule</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679235909"><span class="hs-identifier hs-var">ptn</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="AST.html#ExGlobal"><span class="hs-identifier hs-var">ExGlobal</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
</span><a href="#local-6989586621679235910"><span class="hs-identifier hs-var">cnd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [Extra]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Condition
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-209"></span></pre></body></html>